<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <link href="../style.css" rel="stylesheet">
  <link href="../favicon.ico" rel="icon" sizes="32x32">
  <title>
   Input and compilation/XML source&mdash;ConTeXt Wiki Mirror
  </title>
  <link href="https://wiki.contextgarden.net/Input_and_compilation/XML_source" rel="canonical">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="#241504" name="theme-color">
  <meta content="light dark" name="color-scheme">
 </head>
 <body>
  <header>
   <h1 id="page-title">
    Input and compilation/XML source
   </h1>
   <p>Unofficial <a href="https://wiki.contextgarden.net/">ConTeXt Wiki</a> mirror</p>
   <p>Last modified: <a href="https://wiki.contextgarden.net/index.php?curid=740&diff=39566">2025-01-12</a>
        </p>
  </header>
  <article>
   <div class="mw-parser-output">
    <div class="toc" id="toc">
     <input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox">
     <div class="toctitle" dir="ltr" lang="en">
      <h3>
       Contents
      </h3>
      <span class="toctogglespan">
       <label class="toctogglelabel" for="toctogglecheckbox">
       </label>
      </span>
     </div>
     <ul>
      <li class="toclevel-1 tocsection-1">
       <a href="#Introduction">
        <span class="tocnumber">
         1
        </span>
        <span class="toctext">
         Introduction
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-2">
       <a href="#Before_You_Start">
        <span class="tocnumber">
         2
        </span>
        <span class="toctext">
         Before You Start
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-3">
       <a href="#Sample_XML_Source">
        <span class="tocnumber">
         3
        </span>
        <span class="toctext">
         Sample XML Source
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-4">
       <a href="#Only_XML_Required">
        <span class="tocnumber">
         4
        </span>
        <span class="toctext">
         Only XML Required
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-5">
       <a href="#Sample_Environment_.28or_Configuration_File.29">
        <span class="tocnumber">
         5
        </span>
        <span class="toctext">
         Sample Environment (or Configuration File)
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-6">
       <a href="#Invoking_ConTeXt">
        <span class="tocnumber">
         6
        </span>
        <span class="toctext">
         Invoking ConTeXt
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-7">
       <a href="#XML_Typesetting">
        <span class="tocnumber">
         7
        </span>
        <span class="toctext">
         XML Typesetting
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-8">
       <a href="#Mapping_Selections">
        <span class="tocnumber">
         8
        </span>
        <span class="toctext">
         Mapping Selections
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-9">
       <a href="#XML_Paths_.28or_LPaths.29">
        <span class="tocnumber">
         9
        </span>
        <span class="toctext">
         XML Paths (or LPaths)
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-10">
       <a href="#Defining_ConTeXt_Setups">
        <span class="tocnumber">
         10
        </span>
        <span class="toctext">
         Defining ConTeXt Setups
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-11">
       <a href="#Map_Registration">
        <span class="tocnumber">
         11
        </span>
        <span class="toctext">
         Map Registration
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-12">
       <a href="#Format_.28Setups_Configuration.29">
        <span class="tocnumber">
         12
        </span>
        <span class="toctext">
         Format (Setups Configuration)
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-13">
       <a href="#See_Also">
        <span class="tocnumber">
         13
        </span>
        <span class="toctext">
         See Also
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-14">
       <a href="#Notes">
        <span class="tocnumber">
         14
        </span>
        <span class="toctext">
         Notes
        </span>
       </a>
      </li>
     </ul>
    </div>
    <h2>
     <span class="mw-headline" id="Introduction">
      Introduction
     </span>
    </h2>
    <p>It is possible to typeset XML sources with ConTeXt. Only an environment (or configuration file) is needed.
</p>
    <p>ConTeXt has been dealing with XML since MkII. This also means that the documentation for that version is obsolete for MkIV (or LMTX).<sup class="reference" id="cite_ref-1"><a href="#cite_note-1">[1]</a></sup>
</p>
    <p>The wiki contains only an explanation for the current way of dealing with XML in ConTeXt (MkIV and later).
</p>
    <h2>
     <span class="mw-headline" id="Before_You_Start">
      Before You Start
     </span>
    </h2>
    <p>It might be obvious, but there are two basic requirements to typeset XML sources with ConTeXt:
</p>
    <ol>
     <li>
      Familiarity with XML. You don&rsquo;t have to type XML directly, but ConTeXt isn&rsquo;t able to compile well&ndash;formed XML.
      <sup class="reference" id="cite_ref-2">
       <a href="#cite_note-2">
        [2]
       </a>
      </sup>
     </li>
     <li>
      At least, some knowledge of ConTeXt commands, since otherwise formatting what you select from the XML source would be impossible.
     </li>
    </ol>
    <p>XML is way more powerful than being source format to typeset with ConTeXt. They are also completely independent from each other. It is important to deal with XML first without seeing it through ConTeXt lenses.
</p>
    <p>As for typing directly XML sources, there are some lightweight tagging (or markup) languages, such as AsciiDoc or Markdown.<sup class="reference" id="cite_ref-3"><a href="#cite_note-3">[3]</a></sup> There are tools (<a class="external text" href="https://pandoc.org" rel="nofollow">Pandoc</a> being just one of them) that generate XML from these lightweight markup formats. 
It is not entirely impossible that in some cases these tools might generate wrong XML format (due to bugs in them). In that case, you will have to find out what is wrong with your XML source.<sup class="reference" id="cite_ref-4"><a href="#cite_note-4">[4]</a></sup>
</p>
    <p>Knowing ConTeXt is required too, because typesetting XML may be explained as having two parts:
</p>
    <ul>
     <li>
      Selecting what you want from the XML file(s).
     </li>
     <li>
      Defining how you want your selections in the final PDF document.
     </li>
    </ul>
    <p>It is better to start learning standard ConTeXt first (if required) and then acquire some experience with XML files.  
</p>
    <h2>
     <span class="mw-headline" id="Sample_XML_Source">
      Sample XML Source
     </span>
    </h2>
    <p>An XML sample borrowed and adapted from the net reads:
</p>
    <pre class="xml"><span class="br">&lt;</span><span class="name">TEI xml:lang="en"</span><span class="br">&gt;</span>
  <span class="br">&lt;</span><span class="name">teiHeader</span><span class="br">&gt;</span>
    <span class="comment">&lt;!-- stuff omitted here --&gt;</span>

  <span class="br">&lt;</span><span class="name">/teiHeader</span><span class="br">&gt;</span>
  <span class="br">&lt;</span><span class="name">text</span><span class="br">&gt;</span>
    <span class="br">&lt;</span><span class="name">body</span><span class="br">&gt;</span>
      <span class="br">&lt;</span><span class="name">div type="essay"</span><span class="br">&gt;</span>
        <span class="br">&lt;</span><span class="name">head</span><span class="br">&gt;</span>An Essay on Summer<span class="br">&lt;</span><span class="name">/head</span><span class="br">&gt;</span>
        <span class="br">&lt;</span><span class="name">p</span><span class="br">&gt;</span>Summer school in <span class="br">&lt;</span><span class="name">date when="1990"</span><span class="br">&gt;</span>MCMXC<span class="br">&lt;</span><span class="name">/date</span><span class="br">&gt;</span> was never easy; 
        it went by too quickly and left us wanting more.<span class="br">&lt;</span><span class="name">/p</span><span class="br">&gt;</span>
        <span class="br">&lt;</span><span class="name">p</span><span class="br">&gt;</span>But, as my friend <span class="br">&lt;</span><span class="name">name type="person"</span><span class="br">&gt;</span>Peter<span class="br">&lt;</span><span class="name">/name</span><span class="br">&gt;</span> said with his 
        inimitable <span class="br">&lt;</span><span class="name">foreign xml:lang="fr"</span><span class="br">&gt;</span>je ne sais quoi<span class="br">&lt;</span><span class="name">/foreign</span><span class="br">&gt;</span>, 
        <span class="br">&lt;</span><span class="name">said</span><span class="br">&gt;</span>It never pays to think too hard<span class="br">&lt;</span><span class="name">/said</span><span class="br">&gt;</span>. Or, as I would rather 
        put it, <span class="br">&lt;</span><span class="name">quote xml:lang="it"</span><span class="br">&gt;</span>Que sera, sera<span class="br">&lt;</span><span class="name">/quote</span><span class="br">&gt;</span>.<span class="br">&lt;</span><span class="name">/p</span><span class="br">&gt;</span>
      <span class="br">&lt;</span><span class="name">/div</span><span class="br">&gt;</span>
      <span class="br">&lt;</span><span class="name">div type="essay"</span><span class="br">&gt;</span>
        <span class="br">&lt;</span><span class="name">head</span><span class="br">&gt;</span>An Essay on Winter<span class="br">&lt;</span><span class="name">/head</span><span class="br">&gt;</span>
        <span class="br">&lt;</span><span class="name">p xml:lang="es"</span><span class="br">&gt;</span>&iexcl;Hasta la vista&hellip;!<span class="br">&lt;</span><span class="name">/p</span><span class="br">&gt;</span>
      <span class="br">&lt;</span><span class="name">/div</span><span class="br">&gt;</span>
    <span class="br">&lt;</span><span class="name">/body</span><span class="br">&gt;</span>
  <span class="br">&lt;</span><span class="name">/text</span><span class="br">&gt;</span>
<span class="br">&lt;</span><span class="name">/TEI</span><span class="br">&gt;</span>
</pre>
    <h2>
     <span class="mw-headline" id="Only_XML_Required">
      Only XML Required
     </span>
    </h2>
    <p>This previous sample is written using the TEI markup. It is correct XML and valid (TEI) XML.
</p>
    <p>You might think XML correctness<sup class="reference" id="cite_ref-5"><a href="#cite_note-5">[5]</a></sup> as the set orthographical rules common to all European languages. Some of these rules may be:<sup class="reference" id="cite_ref-6"><a href="#cite_note-6">[6]</a></sup>
</p>
    <ul>
     <li>
      All words are separated using at least a blank space.
     </li>
     <li>
      Single dots mark different sentences.
     </li>
     <li>
      Blank vertical space separates paragraph (when available.
     </li>
    </ul>
    <p>XML rules describe how the tags inside the characters <code>&lt;&hellip;&gt;</code> are to be used. To these rules belong:
</p>
    <ul>
     <li>
      Markup is defined by the string inside the characters
      <code>&lt; &gt;</code>
      .
     </li>
     <li>
      Any blank space separates attributes (
      <code>&lt;element attribute="value" attribute1="value1"&gt;</code>
      ).
     </li>
     <li>
      The name is the only required part for the
      <code>&lt;&hellip;&gt;</code>
      tag.
     </li>
     <li>
      Elements have opening tag and a matching closing tag (
      <code>&lt;&hellip;&gt;</code>
      and
      <code>&lt;/&hellip;&gt;</code>
      ), otherwise the opening tag must autoclose (
      <code>&lt;&hellip;/&gt;</code>
      )
      <sup class="reference" id="cite_ref-7">
       <a href="#cite_note-7">
        [7]
       </a>
      </sup>
      .
     </li>
     <li>
      The name must come first in the tag (before the first space, if any attribute is given).
     </li>
     <li>
      Attributes have their values assigned with the equal sign (and no blank space before or after the sign).
     </li>
     <li>
      Attributes have their values enclosed in quotes.
     </li>
    </ul>
    <p>Validity is related to a document type. XML validity is properly the document validity.
</p>
    <p>A document type (such as XHTML or TEI) defines a limited set of elements (of element names). Each element may contain one or more attributes with different values.
</p>
    <p>This specification of XML is called the document type definition. You may consider it as the set of grammar rules of each European language.
</p>
    <p>For example, <code>&lt;whatever&gt;</code> is a correct pure XML name, but it is invalid XHTML or TEI element.
</p>
    <p>An even more extreme sample of correct XML would read:
</p>
    <pre class="xml"><span class="br">&lt;</span><span class="name">&tau;&epsilon;&chi;&tau;</span><span class="br">&gt;</span>
  <span class="br">&lt;</span><span class="name">&beta;&omicron;&delta;&upsilon;</span><span class="br">&gt;</span>
    <span class="br">&lt;</span><span class="name">&delta;&iota;&beta; type="essay"</span><span class="br">&gt;</span>
      <span class="br">&lt;</span><span class="name">ἡ&alpha;&delta;</span><span class="br">&gt;</span>An Essay on Summer<span class="br">&lt;</span><span class="name">/ἡ&alpha;&delta;</span><span class="br">&gt;</span>
      <span class="br">&lt;</span><span class="name">&pi;</span><span class="br">&gt;</span>Summer school in <span class="br">&lt;</span><span class="name">&delta;&alpha;&tau;&eta; when="1990"</span><span class="br">&gt;</span>MCMXC<span class="br">&lt;</span><span class="name">/&delta;&alpha;&tau;&eta;</span><span class="br">&gt;</span> was never easy;
      it went by too quickly and left us wanting more.<span class="br">&lt;</span><span class="name">/&pi;</span><span class="br">&gt;</span>
      <span class="br">&lt;</span><span class="name">&pi;</span><span class="br">&gt;</span>But, as my friend <span class="br">&lt;</span><span class="name">&nu;&alpha;&mu;&eta; type="person"</span><span class="br">&gt;</span>Peter<span class="br">&lt;</span><span class="name">/&nu;&alpha;&mu;&eta;</span><span class="br">&gt;</span> said with his
      inimitable <span class="br">&lt;</span><span class="name">&xi;έ&nu;&omicron;&nu; xml:lang="fr"</span><span class="br">&gt;</span>je ne sais quoi<span class="br">&lt;</span><span class="name">/&xi;έ&nu;&omicron;&nu;</span><span class="br">&gt;</span>,
      <span class="br">&lt;</span><span class="name">ἔ&phi;&alpha;</span><span class="br">&gt;</span>It never pays to think too hard<span class="br">&lt;</span><span class="name">/ἔ&phi;&alpha;</span><span class="br">&gt;</span>. Or, as I would rather
      put it, <span class="br">&lt;</span><span class="name">&lambda;&epsilon;&gamma;ό&mu;&epsilon;&nu;&omicron;&nu; xml:lang="it"</span><span class="br">&gt;</span>Que sera, sera<span class="br">&lt;</span><span class="name">/&lambda;&epsilon;&gamma;ό&mu;&epsilon;&nu;&omicron;&nu;</span><span class="br">&gt;</span>.<span class="br">&lt;</span><span class="name">/&pi;</span><span class="br">&gt;</span>
    <span class="br">&lt;</span><span class="name">/&delta;&iota;&beta;</span><span class="br">&gt;</span>
    <span class="br">&lt;</span><span class="name">&delta;&iota;&beta; type="essay"</span><span class="br">&gt;</span>
      <span class="br">&lt;</span><span class="name">ἡ&alpha;&delta;</span><span class="br">&gt;</span>An Essay on Winter<span class="br">&lt;</span><span class="name">/ἡ&alpha;&delta;</span><span class="br">&gt;</span>
      <span class="br">&lt;</span><span class="name">&pi; xml:lang="es"</span><span class="br">&gt;</span>&iexcl;Hasta la vista&hellip;!<span class="br">&lt;</span><span class="name">/&pi;</span><span class="br">&gt;</span>
    <span class="br">&lt;</span><span class="name">/&delta;&iota;&beta;</span><span class="br">&gt;</span>
  <span class="br">&lt;</span><span class="name">/&beta;&omicron;&delta;&upsilon;</span><span class="br">&gt;</span>
<span class="br">&lt;</span><span class="name">/&tau;&epsilon;&chi;&tau;</span><span class="br">&gt;</span>
</pre>
    <p>This is invalid TEI. But ConTeXt only requires correct (or valid, as it describes them) XML sources to compile them.
</p>
    <h2>
     <span id="Sample_Environment_(or_Configuration_File)">
     </span>
     <span class="mw-headline" id="Sample_Environment_.28or_Configuration_File.29">
      Sample Environment (or Configuration File)
     </span>
    </h2>
    <p>A minimal configuration file or environment to typeset the previous sample may read:
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:presets:all
  <span class="cs"><span class="stylecs">\xmlsetsetup</span></span> <span class="br">{</span><span class="brx">#</span>1<span class="br">}</span> <span class="br">{</span>*<span class="br">}</span> <span class="br">{</span>xml:*<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs">\xmlregistersetup</span><span class="br">{</span>xml:presets:all<span class="br">}</span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:TEI
  <span class="cs"><span class="stylecs">\mainlanguage</span></span><span class="brx">[</span><span class="cs"><span class="stylecs">\xmlatt</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="br">{</span>xml:lang<span class="br">}</span><span class="brx">]</span>
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:body
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:date
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:div
  <span class="cs"><span class="documentcs">\startchapter</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="cs"><span class="stylecs">\xmltext</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="br">{</span>head<span class="br">}</span><span class="brx">]</span>
    <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
  <span class="cs"><span class="documentcs">\stopchapter</span></span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:foreign
  <span class="cs">\bgroup</span><span class="cs"><span class="documentcs">\language</span></span><span class="brx">[</span><span class="cs"><span class="stylecs">\xmlatt</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="br">{</span>xml:lang<span class="br">}</span><span class="brx">]</span><span class="cs"><span class="documentcs">\em</span></span><span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="cs">\egroup</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:name
  <span class="cs">\bgroup</span><span class="cs">\sc</span><span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="cs">\egroup</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:p
  <span class="cs"><span class="documentcs">\startparagraph</span></span>
    <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
  <span class="cs"><span class="documentcs">\stopparagraph</span></span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:p:date
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:quote
  <span class="cs">\bgroup</span><span class="cs"><span class="documentcs">\language</span></span><span class="brx">[</span><span class="cs"><span class="stylecs">\xmlatt</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="br">{</span>xml:lang<span class="br">}</span><span class="brx">]</span><span class="cs"><span class="documentcs">\quotation</span></span><span class="br">{</span><span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="br">}</span><span class="cs">\egroup</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:said
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:teiHeader
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:text
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>
</pre>
    <p>A proper explanation in <a href="#XML_Typesetting">XML Typesetting</a>.
</p>
    <h2>
     <span class="mw-headline" id="Invoking_ConTeXt">
      Invoking ConTeXt
     </span>
    </h2>
    <p>The XML source may be saved as <code>source.xml</code> and the environment or configuration file could be saved as <code>environment.tex</code>.<sup class="reference" id="cite_ref-8"><a href="#cite_note-8">[8]</a></sup>
</p>
    <pre>context --environment=environment.tex source.xml</pre>
    <p>This invocation will generate an output file named <code>source.pdf</code>.
</p>
    <h2>
     <span class="mw-headline" id="XML_Typesetting">
      XML Typesetting
     </span>
    </h2>
    <p>Formatting XML sources with ConTeXt (or properly typesetting them) requires:
</p>
    <ul>
     <li>
      Selecting which parts you want to be typeset. At least, these selections will cover elements by their name.
     </li>
     <li>
      Assigning these parts to single configuration commands (otherwise all will be displayed the same).
     </li>
    </ul>
    <p>In practice, the ConTeXt configuration for XML (or environment file) contains:
</p>
    <ol>
     <li>
      A set of XML (node) selections mapped or assigned to ConTeXt setups (or configurations).
     </li>
     <li>
      The registration of this mapping (or assignation set).
     </li>
     <li>
      The configuration of each setup.
     </li>
    </ol>
    <p>A basic skeleton showing the three tasks would read:
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:whatever
  <span class="cs"><span class="stylecs">\xmlsetsetup</span></span> <span class="br">{</span><span class="brx">#</span>1<span class="br">}</span> <span class="br">{</span>*<span class="br">}</span> <span class="br">{</span>xml:*<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs">\xmlregistersetup</span><span class="br">{</span>xml:whatever<span class="br">}</span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:body
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>
<span class="comment">% and so many definitions as XML selections</span>
</pre>
    <p>The two blank lines separate the three parts listed above.
</p>
    <h2>
     <span class="mw-headline" id="Mapping_Selections">
      Mapping Selections
     </span>
    </h2>
    <p>The first thing to define is a list of selections from the XML source linked to invidual ConTeXt configurations.
</p>
    <p>This minimal sample contains it:
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:whatever
  <span class="cs"><span class="stylecs">\xmlsetsetup</span></span> <span class="br">{</span><span class="brx">#</span>1<span class="br">}</span> <span class="br">{</span>*<span class="br">}</span> <span class="br">{</span>xml:*<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>
</pre>
    <ol>
     <li>
      The first line
      <tt>
       <a class="new" href="../index.php?title=Command/startxmlsetups&action=edit&redlink=1.html" title="Command/startxmlsetups (page does not exist)">
        \startxmlsetups
       </a>
      </tt>
      creates the list (named
      <code>xml:whatever</code>
      ).
      <ol>
       <li>
        The same identifier will be required to register the list.
       </li>
       <li>
        It is customary to use
        <code>xml:</code>
        as namespace, but any character string (such as
        <code>&omicron;ὑ&delta;έ&nu;:</code>
        ) would do.
       </li>
       <li>
        Both parts of the name are free, but the identifier should match completely in the registration.
       </li>
      </ol>
     </li>
     <li>
      The third line
      <tt>
       <a class="new" href="../index.php?title=Command/stopxmlsetups&action=edit&redlink=1.html" title="Command/stopxmlsetups (page does not exist)">
        \stopxmlsetups
       </a>
      </tt>
      closes the
      <tt>
       <a class="new" href="../index.php?title=Command/startxmlsetups&action=edit&redlink=1.html" title="Command/startxmlsetups (page does not exist)">
        \startxmlsetups
       </a>
      </tt>
      (as customary in ConTeXt.
     </li>
     <li>
      The second line
      <tt>
       <a class="new" href="../index.php?title=Command/xmlsetsetup&action=edit&redlink=1.html" title="Command/xmlsetsetup (page does not exist)">
        \xmlsetsetup
       </a>
      </tt>
      assigns individual selections in XML with ConTeXt format.
      <ol>
       <li>
        In
        <tt>
         <a class="new" href="../index.php?title=Command/xmlsetsetup&action=edit&redlink=1.html" title="Command/xmlsetsetup (page does not exist)">
          \xmlsetsetup
         </a>
        </tt>
        , the second pair of braces defines the individual XML selection, the third pair of braces defines the ConTeXt setup.
       </li>
       <li>
        The content of the first pair of braces (
        <tt>
         <a class="new" href="../index.php?title=Command/xmlsetsetup&action=edit&redlink=1.html" title="Command/xmlsetsetup (page does not exist)">
          \xmlsetsetup
         </a>
         {#1
        </tt>
        }) is required in all cases.
       </li>
      </ol>
     </li>
    </ol>
    <h2>
     <span id="XML_Paths_(or_LPaths)">
     </span>
     <span class="mw-headline" id="XML_Paths_.28or_LPaths.29">
      XML Paths (or LPaths)
     </span>
    </h2>
    <p>You define what you want form the XML sources using XML Paths, known as XPaths. Since ConTeXt access these paths using Lua, they are LPaths.
</p>
    <p>We are handling the contents of the second pair of braces from the command:
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\xmlsetsetup</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="br">{</span>*<span class="br">}</span><span class="br">{</span>xml:*<span class="br">}</span>
</pre>
    <p>The most basic path is the one used in the sample <code>{*}&ZeroWidthSpace;</code>, which stands for any XML element.
</p>
    <p>Other path types may be:
</p>
    <ul>
     <li>
      <code>{element[@attribute]</code>
      }, selects
      <code>&lt;element attribute="&hellip;"&gt;</code>
      (
      <code>&lt;element&gt;</code>
      with
      <code>attribute</code>
      set, regardless of its value).
     </li>
     <li>
      <code>{element[@attribute='value']</code>
      } selects
      <code>&lt;element attribute="value"&gt;</code>
      , but not
      <code>&lt;element attribute="value1"&gt;</code>
      (or even
      <code>&lt;element attribute="value another-value"&gt;</code>
      ).
     </li>
     <li>
      <code>{container/element</code>
      } selects all
      <code>&lt;element&gt;</code>
      children (or direct descendants) of
      <code>&lt;container&gt;</code>
      .
     </li>
    </ul>
    <p>There are a bunch of other possibilities. A separate page on <a class="new" href="../index.php?title=LPaths&action=edit&redlink=1" title="LPaths (page does not exist)">LPaths</a> would make more sense.
</p>
    <h2>
     <span class="mw-headline" id="Defining_ConTeXt_Setups">
      Defining ConTeXt Setups
     </span>
    </h2>
    <p>The third and last pair of braces from <tt><a class="new" href="../index.php?title=Command/xmlsetsetup&action=edit&redlink=1.html" title="Command/xmlsetsetup (page does not exist)">\xmlsetsetup</a>{#1}{*}{xml:*</tt>} defines the matching setup for the given element.
</p>
    <p>If you use wildcard (<code>*</code>) this will take the element name from the path (when a path is selected).
</p>
    <p>It is up to you which namespace you use to name ConTeXt setups,<sup class="reference" id="cite_ref-9"><a href="#cite_note-9">[9]</a></sup> but they must match the individual formatting command.
</p>
    <p>A way of getting rid of some content (which otherwise would be selected) is to match a path with an non&ndash;existing selection.<sup class="reference" id="cite_ref-10"><a href="#cite_note-10">[10]</a></sup>
</p>
    <h2>
     <span class="mw-headline" id="Map_Registration">
      Map Registration
     </span>
    </h2>
    <p>After defining the list of XML setups (XML paths matched with ConTeXt setups), it must be registered. The registration command reads:
</p>
    <pre class="tex"><span class="cs">\xmlregistersetup</span><span class="br">{</span>xml:whatever<span class="br">}</span>
</pre>
    <p>The only requirement is that the identifier (<code>xml:whatever</code> in the sample) is exactly the same that the one defined in <tt><a class="new" href="../index.php?title=Command/startxmlsetups&action=edit&redlink=1.html" title="Command/startxmlsetups (page does not exist)">\startxmlsetups</a></tt>.
</p>
    <h2>
     <span id="Format_(Setups_Configuration)">
     </span>
     <span class="mw-headline" id="Format_.28Setups_Configuration.29">
      Format (Setups Configuration)
     </span>
    </h2>
    <p>Last (but not least, as they say) comes the format of XML selections. Without this step, the selections will be lost in the transition to the output document.
</p>
    <p>As already explained in <a href="#Defining_ConTeXt_Setups">Defining ConTeXt Setups</a>, these names (contained in the last pair of braces of <tt><a class="new" href="../index.php?title=Command/xmlsetsetup&action=edit&redlink=1.html" title="Command/xmlsetsetup (page does not exist)">\xmlsetsetup</a></tt>) should match each indivual setup configuration.
</p>
    <p>For a setup named in the selection mapping <code>{xml:body</code>}, its configuration may read:
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:body
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>
</pre>
    <p>Flushing the contents of the element (the node), it is the most basic operation.
</p>
    <p>This is required to be able to have its children elements.
</p>
    <p>Flushing only adds the text of the element, but for formatting one needs standard ConTeXt command.
</p>
    <p>Compare the previous setup to these other ones:
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:p
  <span class="cs"><span class="documentcs">\startparagraph</span></span>
    <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
  <span class="cs"><span class="documentcs">\stopparagraph</span></span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>

<span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:name
  <span class="cs">\bgroup</span><span class="cs">\sc</span><span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="cs">\egroup</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span>
</pre>
    <p>The <code>xml:p</code> setup adds the required commands so that <code>&lt;p&gt;</code> are handled as commands.
</p>
    <p>For <code>xml:name</code>, small caps are added. <code>\bgroup &hellip; \egroup</code> is similar to enclose its contents in braces (but more explicit and readable).
</p>
    <p>As mentioned, <tt><a class="new" href="../index.php?title=Command/xmlflush&action=edit&redlink=1.html" title="Command/xmlflush (page does not exist)">\xmlflush</a>{#1</tt>} flushes the current selection (or node).
</p>
    <p>This is the most basic operation, but there are other commands as well.
</p>
    <p><tt><a class="new" href="../index.php?title=Command/xmltext&action=edit&redlink=1.html" title="Command/xmltext (page does not exist)">\xmltext</a></tt> adds the text from a path, such as in:
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\xmltext</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="br">{</span>head<span class="br">}</span>

<span class="cs"><span class="stylecs">\xmltext</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span><span class="br">{</span>.<span class="br">}</span>
</pre>
    <p>The first command from the sample gets the text from a child <code>&lt;head&gt;</code> element.
</p>
    <p>The second command gets the text from the current element (<code>{.</code>} is the path for it).
</p>
    <p>Attributes may be accessed with:
</p>
    <ul>
     <li>
      <tt>
       <a class="new" href="../index.php?title=Command/xmlatt&action=edit&redlink=1.html" title="Command/xmlatt (page does not exist)">
        \xmlatt
       </a>
       {#1}{name
      </tt>
      gets the value for the attribute
      <code>{name</code>
      } from the current element.
     </li>
     <li>
      <tt>
       <a class="new" href="../index.php?title=Command/xmlattribute&action=edit&redlink=1.html" title="Command/xmlattribute (page does not exist)">
        \xmlattribute
       </a>
       {#1}{path}{name
      </tt>
      } gets the value for the attribute
      <code>{name</code>
      } from the selected
      <code>{path</code>
      }.
     </li>
    </ul>
    <p>A more detailed list (with sample explanation) deserves a <a href="XML_source/XML_setup_commands.html" title="Input and compilation/XML source/XML setup commands">XML setup commands</a>.
</p>
    <h2>
     <span class="mw-headline" id="See_Also">
      See Also
     </span>
    </h2>
    <ul>
     <li>
      <a href="XML_source/XML_setup_commands.html" title="Input and compilation/XML source/XML setup commands">
       XML setup commands
      </a>
     </li>
     <li>
      <a href="XML_source/XML_documentation.html" title="Input and compilation/XML source/XML documentation">
       XML documentation
      </a>
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Notes">
      Notes
     </span>
    </h2>
    <div class="mw-references-wrap">
     <ol class="references">
      <li id="cite_note-1">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-1">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        In general, old MkII code includes the uppercase
        <tt>
         XML
        </tt>
        string in its commands (as in
        <tt>
         <a class="new" href="../index.php?title=Command/getXMLcode&action=edit&redlink=1.html" title="Command/getXMLcode (page does not exist)">
          \getXMLcode
         </a>
         [name])
        </tt>
        , while new MkIV code uses lowercase
        <tt>
         xml
        </tt>
        (as in
        <tt>
         <a class="new" href="../index.php?title=Command/xmlflush&action=edit&redlink=1.html" title="Command/xmlflush (page does not exist)">
          \xmlflush
         </a>
         {#1
        </tt>
        }).
       </span>
      </li>
      <li id="cite_note-2">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-2">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        If this is all Greek to you, consider it as incorrect XML.
       </span>
      </li>
      <li id="cite_note-3">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-3">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        For a detailed list, see
        <a class="external text" href="https://en.wikipedia.org/wiki/Lightweight_markup_language#Comparison_of_language_features" rel="nofollow">
         a feature comparison list in Wikipedia
        </a>
        .
       </span>
      </li>
      <li id="cite_note-4">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-4">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        ConTeXt will complain with a message in the PDF document starting with &ldquo;invalid xml file&rdquo;.
       </span>
      </li>
      <li id="cite_note-5">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-5">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        I&rsquo;m aware that the technical term is well&ndash;formedness, not being able to avoid considering a more expressive replacement. Correctness seems to be a suitable candidate.
       </span>
      </li>
      <li id="cite_note-6">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-6">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        This is not more than a fancy example, in no way an exhaustive description (or list).
       </span>
      </li>
      <li id="cite_note-7">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-7">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        With or without space before the slash.
       </span>
      </li>
      <li id="cite_note-8">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-8">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        Of course, file names should differ in documents. Although not being mandatory (as far as I can recall), it is a good idea to keep different file extensions for each file format. I mean,
        <code>.xml</code>
        for XML files and
        <code>.tex</code>
        for ConTeXt files.
       </span>
      </li>
      <li id="cite_note-9">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-9">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        The part of the identifier with the form
        <code>xml:</code>
        , which may contain any string of letters (no digits).
       </span>
      </li>
      <li id="cite_note-10">
       <span class="mw-cite-backlink">
        <a href="#cite_ref-10">
         &uarr;
        </a>
       </span>
       <span class="reference-text">
        This is exactly what happens with the
        <code>&lt;head&gt;</code>
        element in the sample. There is no defined
        <pre class="tex"><span class="cs"><span class="stylecs">\startxmlsetups</span></span> xml:head
  <span class="cs"><span class="stylecs">\xmlflush</span></span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
<span class="cs"><span class="stylecs">\stopxmlsetups</span></span></pre>
        It would be redundant (appearing twice in the output document), since it is already included with
        <code>xml:div</code>
        with
        <tt>
         <a class="new" href="../index.php?title=Command/xmltext&action=edit&redlink=1.html" title="Command/xmltext (page does not exist)">
          \xmltext
         </a>
         {#1}{head
        </tt>
        }.
       </span>
      </li>
     </ol>
    </div>
   </div>
  </article>
  <footer>
   <ul role="list">
    <li>
     <a href="../index.html">
      Home
     </a>
    </li>
    <li>
     Mirrored on 2026-01-12
    </li>
    <li>
     <a href="http://www.gnu.org/copyleft/fdl.html" rel="license">
      GFDL 1.2
     </a>
    </li>
    <li>
     <a href="https://wiki.contextgarden.net/Input_and_compilation/XML_source">
      Original page
     </a>
    </li>
   </ul>
  </footer>
 </body>
</html>
