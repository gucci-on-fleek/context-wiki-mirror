<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <link href="../style.css" rel="stylesheet">
  <link href="../favicon.ico" rel="icon" sizes="32x32">
  <title>
   Document structure and headlines/Headlines formatting&mdash;ConTeXt Wiki Mirror
  </title>
  <link href="https://wiki.contextgarden.net/Document_structure_and_headlines/Headlines_formatting" rel="canonical">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="#241504" name="theme-color">
  <meta content="light dark" name="color-scheme">
 </head>
 <body>
  <header>
   <h1 id="page-title">
    Document structure and headlines/Headlines formatting
   </h1>
   <p>Unofficial <a href="https://wiki.contextgarden.net/">ConTeXt Wiki</a> mirror</p>
   <p>Last modified: <a href="https://wiki.contextgarden.net/index.php?curid=851&diff=39757">2025-10-07</a>
        </p>
  </header>
  <article>
   <div class="mw-parser-output">
    <div class="toc" id="toc">
     <input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox">
     <div class="toctitle" dir="ltr" lang="en">
      <h3>
       Contents
      </h3>
      <span class="toctogglespan">
       <label class="toctogglelabel" for="toctogglecheckbox">
       </label>
      </span>
     </div>
     <ul>
      <li class="toclevel-1 tocsection-1">
       <a href="#Formatting_Titles_with_.5Csetuphead">
        <span class="tocnumber">
         1
        </span>
        <span class="toctext">
         Formatting Titles with \setuphead
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-2">
       <a href="#Headline_text_alignment_and_hyphenation">
        <span class="tocnumber">
         2
        </span>
        <span class="toctext">
         Headline text alignment and hyphenation
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-3">
       <a href="#Empty_the_headers_of_pages_preceding_a_new_chapter">
        <span class="tocnumber">
         3
        </span>
        <span class="toctext">
         Empty the headers of pages preceding a new chapter
        </span>
       </a>
       <ul>
        <li class="toclevel-2 tocsection-4">
         <a href="#Explanation">
          <span class="tocnumber">
           3.1
          </span>
          <span class="toctext">
           Explanation
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-5">
         <a href="#When_using_macro_divisions_.28front.2C_body.2C_back_matters_and_appendices.29">
          <span class="tocnumber">
           3.2
          </span>
          <span class="toctext">
           When using macro divisions (front, body, back matters and appendices)
          </span>
         </a>
        </li>
       </ul>
      </li>
      <li class="toclevel-1 tocsection-6">
       <a href="#Flushing_headline_data_without_typesetting_them_in_the_text">
        <span class="tocnumber">
         4
        </span>
        <span class="toctext">
         Flushing headline data without typesetting them in the text
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-7">
       <a href="#Use_the_margin">
        <span class="tocnumber">
         5
        </span>
        <span class="toctext">
         Use the margin
        </span>
       </a>
       <ul>
        <li class="toclevel-2 tocsection-8">
         <a href="#Number_in_the_margin">
          <span class="tocnumber">
           5.1
          </span>
          <span class="toctext">
           Number in the margin
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-9">
         <a href="#Headline_in_the_margin">
          <span class="tocnumber">
           5.2
          </span>
          <span class="toctext">
           Headline in the margin
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-10">
         <a href="#Headline_in_the_margin_.282003.29">
          <span class="tocnumber">
           5.3
          </span>
          <span class="toctext">
           Headline in the margin (2003)
          </span>
         </a>
        </li>
       </ul>
      </li>
      <li class="toclevel-1 tocsection-11">
       <a href="#Numbering_and_text_on_separate_lines">
        <span class="tocnumber">
         6
        </span>
        <span class="toctext">
         Numbering and text on separate lines
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-12">
       <a href="#Section_label_in_the_headline">
        <span class="tocnumber">
         7
        </span>
        <span class="toctext">
         Section label in the headline
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-13">
       <a href="#Headline_with_an_enlarged_shadow">
        <span class="tocnumber">
         8
        </span>
        <span class="toctext">
         Headline with an enlarged shadow
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-14">
       <a href="#Completely_replace_the_text_and_chapter_number_with_an_image">
        <span class="tocnumber">
         9
        </span>
        <span class="toctext">
         Completely replace the text and chapter number with an image
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-15">
       <a href="#More_elaborate_headline_composition">
        <span class="tocnumber">
         10
        </span>
        <span class="toctext">
         More elaborate headline composition
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-16">
       <a href="#Title_page_with_special_background">
        <span class="tocnumber">
         11
        </span>
        <span class="toctext">
         Title page with special background
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-17">
       <a href="#Chapter_head_with_absolute_positioning_of_following_text">
        <span class="tocnumber">
         12
        </span>
        <span class="toctext">
         Chapter head with absolute positioning of following text
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-18">
       <a href="#Underlining_to_the_width_of_last_line_of_the_headline">
        <span class="tocnumber">
         13
        </span>
        <span class="toctext">
         Underlining to the width of last line of the headline
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-19">
       <a href="#Headline_including_bold_math">
        <span class="tocnumber">
         14
        </span>
        <span class="toctext">
         Headline including bold math
        </span>
       </a>
      </li>
     </ul>
    </div>
    <h2>
     <span id="Formatting_Titles_with_\setuphead">
     </span>
     <span class="mw-headline" id="Formatting_Titles_with_.5Csetuphead">
      Formatting Titles with
      <tt>
       <a href="../Command/setuphead.html" title="Command/setuphead">
        \setuphead
       </a>
      </tt>
     </span>
    </h2>
    <p><i>For numbering see  <a href="Section_numbering.html" title="Document structure and headlines/Section numbering">Section numbering</a>.</i>
</p>
    <p>The following parameters to <tt><a href="../Command/setuphead.html" title="Command/setuphead">\setuphead</a></tt> change the style of the headlines. 
</p>
    <table class="wikitable">
     <tbody>
      <tr>
       <th>
        Text
       </th>
       <th>
        Number
       </th>
       <th>
        Both
       </th>
      </tr>
      <tr>
       <td>textstyle
</td>
       <td>numberstyle
</td>
       <td>style
</td>
      </tr>
      <tr>
       <td>textcommand
</td>
       <td>numbercommand
</td>
       <td>command
</td>
      </tr>
      <tr>
       <td>deeptextcommand
</td>
       <td>deepnumbercommand
</td>
       <td>&mdash;
</td>
      </tr>
     </tbody>
    </table>
    <p>Quite obviously, the number commands work on the chapter/section/etc. number,
their text counterparts change the text itself. However, there are differences
between <code>style</code>, <code>command</code> and <code>deepcommand</code>.
</p>
    <ul>
     <li>
      The
      <code>style</code>
      variants accept a style (
      <code>bold</code>
      ,
      <code>cap</code>
      , etc.) or a font switch (
      <tt>
       <a href="../Command/em.html" title="Command/em">
        \em
       </a>
      </tt>
      ,
      <tt>
       <a class="new" href="../index.php?title=Command/tfx&action=edit&redlink=1.html" title="Command/tfx (page does not exist)">
        \tfx
       </a>
      </tt>
      , etc).
     </li>
     <li>
      <code>textstyle</code>
      prepends the text with the associated style.
     </li>
     <li>
      <code>textcommand</code>
      is a command name which is given the text (with all markup) as a parameter.
     </li>
     <li>
      <code>deeptextcommand</code>
      is similar to
      <code>textcommand</code>
      but it acts only on the text (not on the markup).
     </li>
    </ul>
    <p>So, if we have <tt><a class="mw-redirect" href="../Command/_section.html" title="Command/title">\title</a>{A story</tt>}, the different parameters have the following results:
</p>
    <table>
     <tbody>
      <tr>
       <td>textstyle=\em
</td>
       <td>=&gt;
</td>
       <td>\em A story
</td>
      </tr>
      <tr>
       <td>textstyle=\em, textcommand=\uppercase
</td>
       <td>=&gt;
</td>
       <td>\uppercase{\em A story}
</td>
       <td>=&gt;
</td>
       <td>\em A STORY
</td>
      </tr>
      <tr>
       <td>textstyle=\em, deeptextcommand=\uppercase
</td>
       <td>=&gt;
</td>
       <td>\em\uppercase{A story}
</td>
       <td>=&gt;
</td>
       <td>\em A STORY
</td>
      </tr>
     </tbody>
    </table>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>textstyle<span class="brx">=</span><span class="cs"><span class="documentcs">\em</span></span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\startsection</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>A story<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>textstyle<span class="brx">=</span><span class="cs"><span class="documentcs">\em</span></span>, 
   textcommand<span class="brx">=</span><span class="cs">\uppercase</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\startsection</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>A story<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>textstyle<span class="brx">=</span><span class="cs"><span class="documentcs">\em</span></span>, 
   deeptextcommand<span class="brx">=</span><span class="cs">\uppercase</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\startsection</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>A story<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/3e8e8752b76b3eff60e63f332bc7f42e.webp" width="438">
     </li>
    </ul>
    <p>What is the difference between <tt>textcommand</tt> and <tt>deeptextcommand</tt>,
then? With this example there is very little difference, as <tt>uppercase</tt>
knows how to handle markup. Sometimes this is not the case. For example, an almost
similar command <tt>WORD</tt> is not compatible with <tt>textcommand</tt>, because
it wreaks havoc with markup:
</p>
    <table>
     <tbody>
      <tr>
       <td>textstyle=\em, textcommand=\WORD
</td>
       <td>=&gt;
</td>
       <td>\WORD{\em A story}
</td>
       <td>=&gt;
</td>
       <td>\EM A STORY
</td>
      </tr>
      <tr>
       <td>textstyle=\em, deeptextcommand=\WORD
</td>
       <td>=&gt;
</td>
       <td>\em\WORD{A story}
</td>
       <td>=&gt;
</td>
       <td>\em A STORY
</td>
      </tr>
     </tbody>
    </table>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>textstyle<span class="brx">=</span><span class="cs"><span class="documentcs">\em</span></span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\startsection</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>A story<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>textstyle<span class="brx">=</span><span class="cs"><span class="documentcs">\em</span></span>, 
   textcommand<span class="brx">=</span><span class="cs"><span class="documentcs">\WORD</span></span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\startsection</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>A story<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>textstyle<span class="brx">=</span><span class="cs"><span class="documentcs">\em</span></span>, 
   deeptextcommand<span class="brx">=</span><span class="cs"><span class="documentcs">\WORD</span></span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\startsection</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>A story<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/d081b2cb6c77bdbabffd4dc08f95e884.webp" width="438">
     </li>
    </ul>
    <p>In this case using <tt>deeptextcommand</tt> is the correct solution for capitalizing
headers. (Using <tt><a class="new" href="../index.php?title=Command/uppercase&action=edit&redlink=1.html" title="Command/uppercase (page does not exist)">\uppercase</a></tt> works in this specific case, but only if you stick
to Latin 1 or Anglo-Saxon characters. Other languages will suffer from lowercase accented
characters, like CAF&eacute;.)
</p>
    <h2>
     <span class="mw-headline" id="Headline_text_alignment_and_hyphenation">
      Headline text alignment and hyphenation
     </span>
    </h2>
    <p>Headlines should often be left aligned without hyphenation. Try this:
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Headline with long words alignment hyphenation<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/3cfb163be4271a69eb6012a6b282f10f.webp" width="438">
     </li>
    </ul>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuphead</span></span>
  <span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>align<span class="brx">=</span><span class="br">{</span>flushleft, nothyphenated, verytolerant<span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Headline with long words alignment hyphenation<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/6e804d446e328cb87c42c9e5b3862f8b.webp" width="438">
     </li>
    </ul>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
  <span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>numberstyle<span class="brx">=</span>bold,
   textstyle<span class="brx">=</span>cap,
   before<span class="brx">=</span><span class="cs"><span class="documentcs">\hairline</span></span><span class="cs"><span class="documentcs">\blank</span></span>,
   after<span class="brx">=</span><span class="cs">\nowhitespace</span><span class="cs"><span class="documentcs">\hairline</span></span>,
   align<span class="brx">=</span><span class="br">{</span>flushleft, nothyphenated, verytolerant<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Hasselt makes headlines<span class="br">}</span>,
   reference<span class="brx">=</span>hasselt-ref<span class="brx">]</span>
Text.
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="438" src="../wikiteximage/4f95d6cf05db5d80b3a7df6aa8ce5e9f.webp" width="307">
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Empty_the_headers_of_pages_preceding_a_new_chapter">
      Empty the headers of pages preceding a new chapter
     </span>
    </h2>
    <p>Using <tt><a href="../Command/setuppagenumbering.html" title="Command/setuppagenumbering">\setuppagenumbering</a>[alternative=doublesided]</tt> makes the chapters start
on the right page. However, the blank page is not truly empty, it contains headers and
footers. 
</p>
    <ul class="demo">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\definepapersize</span></span><span class="brx">[</span>sheet<span class="brx">]</span><span class="brx">[</span>width<span class="brx">=</span>156mm,height<span class="brx">=</span>148mm<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8<span class="brx">]</span><span class="brx">[</span>sheet<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppaper</span></span><span class="brx">[</span>nx<span class="brx">=</span>3,ny<span class="brx">=</span>2<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuparranging</span></span><span class="brx">[</span>XY<span class="brx">]</span>
<span class="cs"><span class="documentcs">\showframe</span></span><span class="brx">[</span>edge<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuphead</span></span> <span class="brx">[</span>align<span class="brx">=</span><span class="br">{</span>flushleft, nothyphenated, verytolerant<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupalign</span></span><span class="brx">[</span>tolerant<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupbodyfont</span></span><span class="brx">[</span>6pt<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppagenumbering</span></span> <span class="brx">[</span>alternative<span class="brx">=</span>doublesided<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setupheadertexts</span></span><span class="brx">[</span><span class="br">{</span><span class="cs">\sc</span><span class="cs"><span class="stylecs">\getmarking</span></span><span class="brx">[</span>chapter<span class="brx">]</span><span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupfootertexts</span></span> <span class="brx">[</span><span class="br">{</span>rightpage<span class="br">}</span><span class="brx">]</span>  <span class="brx">[</span>pagenumber<span class="brx">]</span> <span class="brx">[</span>pagenumber<span class="brx">]</span> <span class="brx">[</span><span class="br">{</span>leftpage<span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startchapter</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Chapter A<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="systemcs">\dorecurse</span></span><span class="br">{</span>3<span class="br">}</span><span class="br">{</span><span class="cs"><span class="documentcs">\input</span></span> tufte<span class="br">}</span>
<span class="cs"><span class="documentcs">\stopchapter</span></span>
<span class="cs"><span class="documentcs">\startchapter</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Chapter B<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="systemcs">\dorecurse</span></span><span class="br">{</span>3<span class="br">}</span><span class="br">{</span><span class="cs"><span class="documentcs">\input</span></span> tufte<span class="br">}</span>
<span class="cs"><span class="documentcs">\stopchapter</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span> 
</pre>
     </li>
     <li class="rendering">
      <img height="874" src="../wikiteximage/bb586a720decb9dcaa1c10683fe78f01.webp" width="921">
     </li>
    </ul>
    <p>To get truly empty pages, use <tt><a href="../Command/definepagebreak.html" title="Command/definepagebreak">\definepagebreak</a></tt> and <tt><a href="../Command/setuphead.html" title="Command/setuphead">\setuphead</a></tt> with the option  <code>page=</code>. See the following:
</p>
    <ul class="demo">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\definepapersize</span></span><span class="brx">[</span>sheet<span class="brx">]</span><span class="brx">[</span>width<span class="brx">=</span>156mm,height<span class="brx">=</span>148mm<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8<span class="brx">]</span><span class="brx">[</span>sheet<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppaper</span></span><span class="brx">[</span>nx<span class="brx">=</span>3,ny<span class="brx">=</span>2<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuparranging</span></span><span class="brx">[</span>XY<span class="brx">]</span>
<span class="cs"><span class="documentcs">\showframe</span></span><span class="brx">[</span>edge<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuphead</span></span> <span class="brx">[</span>align<span class="brx">=</span><span class="br">{</span>flushleft, nothyphenated, verytolerant<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupalign</span></span><span class="brx">[</span>tolerant<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupbodyfont</span></span><span class="brx">[</span>6pt<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppagenumbering</span></span> <span class="brx">[</span>alternative<span class="brx">=</span>doublesided<span class="brx">]</span>

<span class="cs"><span class="stylecs">\definepagebreak</span></span>                 <span class="comment">% HERE /!\</span>
  <span class="brx">[</span>mychapterpagebreak<span class="brx">]</span>
  <span class="brx">[</span>yes,header,right<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
  <span class="brx">[</span>chapter<span class="brx">]</span>
  <span class="brx">[</span>page<span class="brx">=</span>mychapterpagebreak<span class="brx">]</span>      <span class="comment">% AND HERE /!\</span>

<span class="cs"><span class="stylecs">\setupheadertexts</span></span><span class="brx">[</span><span class="br">{</span><span class="cs">\sc</span><span class="cs"><span class="stylecs">\getmarking</span></span><span class="brx">[</span>chapter<span class="brx">]</span><span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupfootertexts</span></span> <span class="brx">[</span><span class="br">{</span>rightpage<span class="br">}</span><span class="brx">]</span>  <span class="brx">[</span>pagenumber<span class="brx">]</span> <span class="brx">[</span>pagenumber<span class="brx">]</span> <span class="brx">[</span><span class="br">{</span>leftpage<span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startchapter</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Chapter A<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="systemcs">\dorecurse</span></span><span class="br">{</span>3<span class="br">}</span><span class="br">{</span><span class="cs"><span class="documentcs">\input</span></span> tufte<span class="br">}</span>
<span class="cs"><span class="documentcs">\stopchapter</span></span>
<span class="cs"><span class="documentcs">\startchapter</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Chapter B<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="systemcs">\dorecurse</span></span><span class="br">{</span>3<span class="br">}</span><span class="br">{</span><span class="cs"><span class="documentcs">\input</span></span> tufte<span class="br">}</span>
<span class="cs"><span class="documentcs">\stopchapter</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span> 
</pre>
     </li>
     <li class="rendering">
      <img height="874" src="../wikiteximage/54f9170935f9679a7dddc9d67d760ca5.webp" width="921">
     </li>
    </ul>
    <h3>
     <span class="mw-headline" id="Explanation">
      Explanation
     </span>
    </h3>
    <ul>
     <li>
      You define a new pagebreak rule. It has the name
      <code>mychapterpagebreak</code>
      . The options set read as:
      <code>pagebreak=yes</code>
      , placeheader, use a right page.
     </li>
     <li>
      You set options for the header of type chapter and use for the option  page the afore defined new pagebreak.
     </li>
     <li>
      You might want to experiment with the commented lines and see what happens.  For example, the
      <tt>
       <a href="../Command/setupsectionblock.html" title="Command/setupsectionblock">
        \setupsectionblock
       </a>
      </tt>
      commands will give a truly blank page (if needed) after the specified
      <code>stop*part</code>
      command.
     </li>
    </ul>
    <h3>
     <span id="When_using_macro_divisions_(front,_body,_back_matters_and_appendices)">
     </span>
     <span class="mw-headline" id="When_using_macro_divisions_.28front.2C_body.2C_back_matters_and_appendices.29">
      When using macro divisions (front, body, back matters and appendices)
     </span>
    </h3>
    <p>When using <code>*frontmatter</code>, <code>*bodymatter</code>, <code>*backmatter</code> and <code>*appendices</code>, you need to remove the page they create to get the page before a new chapter or part with no headers and footers.
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\setupsectionblock</span></span> <span class="brx">[</span>frontpart<span class="brx">]</span> <span class="brx">[</span>page<span class="brx">=</span><span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupsectionblock</span></span> <span class="brx">[</span>bodypart<span class="brx">]</span> <span class="brx">[</span>page<span class="brx">=</span><span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupsectionblock</span></span> <span class="brx">[</span>backpart<span class="brx">]</span> <span class="brx">[</span>page<span class="brx">=</span><span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupsectionblock</span></span> <span class="brx">[</span>appendix<span class="brx">]</span> <span class="brx">[</span>page<span class="brx">=</span><span class="brx">]</span>

<span class="cs"><span class="stylecs">\definepagebreak</span></span> <span class="brx">[</span>firstpagebreak<span class="brx">]</span> <span class="brx">[</span>yes,header,footer,right<span class="brx">]</span>  <span class="comment">% HERE</span>
<span class="cs"><span class="stylecs">\setuphead</span></span> <span class="brx">[</span>chapter<span class="brx">]</span> <span class="brx">[</span>page<span class="brx">=</span>firstpagebreak<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuppagenumbering</span></span><span class="brx">[</span>alternative<span class="brx">=</span>doublesided<span class="brx">]</span>
<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startfrontmatter</span></span>
<span class="cs"><span class="documentcs">\chapter</span></span><span class="br">{</span>front<span class="br">}</span>
<span class="cs"><span class="documentcs">\stopfrontmatter</span></span>
<span class="cs"><span class="documentcs">\startbodymatter</span></span>
<span class="cs"><span class="documentcs">\chapter</span></span><span class="br">{</span>body<span class="br">}</span>
<span class="cs"><span class="documentcs">\stopbodymatter</span></span>
<span class="cs"><span class="documentcs">\startappendices</span></span>
<span class="cs"><span class="documentcs">\chapter</span></span><span class="br">{</span>appendix<span class="br">}</span>
<span class="cs"><span class="documentcs">\stopappendices</span></span>
<span class="cs"><span class="documentcs">\startbackmatter</span></span>
<span class="cs"><span class="documentcs">\chapter</span></span><span class="br">{</span>back<span class="br">}</span>
<span class="cs"><span class="documentcs">\stopbackmatter</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
    <h2>
     <span class="mw-headline" id="Flushing_headline_data_without_typesetting_them_in_the_text">
      Flushing headline data without typesetting them in the text
     </span>
    </h2>
    <p>The following is probably a very special case. Hoever suppose you need to place section information like the title e.g. in the topspace area. You want that the section is still displayed in the TOC, but you do not want that at the spot where <tt><a class="mw-redirect" href="../Command/_startsection.html" title="Command/startsection">\startsection</a>[title=...,list=...]</tt> resides there is any trace of it. The command to be used to hide the section title is:
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\setuphead</span></span>
   <span class="brx">[</span>section<span class="brx">]</span>
   <span class="brx">[</span>placehead<span class="brx">=</span>hidden<span class="brx">]</span> 
</pre>
    <p>Be aware that with this setting indeed the section title is not shown and no white space is inserted. However in this way also the list entry for the TOC is gone. What you can do in such cases is to use the following command in connection with the above mentioned setting:
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\setuptexttexts</span></span><span class="brx">[</span><span class="br">{</span><span class="cs"><span class="systemcs">\placerawheaddata</span></span><span class="brx">[</span>section<span class="brx">]</span><span class="br">}</span> 
</pre>
    <p>What happens is that the information in the <tt><a class="mw-redirect" href="../Command/_startsection.html" title="Command/startsection">\startsection</a>[title=...,list=...]</tt> command is passed to the texttexts, which are flushed at every page. In order to see when it is flushed you might place e.g.&nbsp;!!! in front of the <tt><a class="new" href="../index.php?title=Command/placerawheaddata&action=edit&redlink=1.html" title="Command/placerawheaddata (page does not exist)">\placerawheaddata</a>[section]</tt>.
</p>
    <p>The result is a complete TOC without any trace of the section heading in the text.
</p>
    <p>Demo:
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\definepapersize</span></span><span class="brx">[</span>sheet<span class="brx">]</span><span class="brx">[</span>width<span class="brx">=</span>104mm,height<span class="brx">=</span>148mm<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8<span class="brx">]</span><span class="brx">[</span>sheet<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppaper</span></span><span class="brx">[</span>nx<span class="brx">=</span>2,ny<span class="brx">=</span>2<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuparranging</span></span><span class="brx">[</span>XY<span class="brx">]</span>
<span class="cs"><span class="documentcs">\showframe</span></span><span class="brx">[</span>edge<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
   <span class="brx">[</span>section<span class="brx">]</span>
   <span class="brx">[</span>placehead<span class="brx">=</span>hidden,
    page<span class="brx">=</span>yes<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
   <span class="brx">[</span>subsection<span class="brx">]</span>
   <span class="brx">[</span>placehead<span class="brx">=</span>yes,
    page<span class="brx">=</span>yes,
    continue<span class="brx">=</span>yes,
    style<span class="brx">=</span><span class="cs">\it</span><span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuptexttexts</span></span><span class="brx">[</span><span class="br">{</span><span class="cs"><span class="systemcs">\placerawheaddata</span></span><span class="brx">[</span>section<span class="brx">]</span><span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>

<span class="cs"><span class="documentcs">\placelist</span></span><span class="brx">[</span>section,subsection<span class="brx">]</span> 

<span class="cs"><span class="documentcs">\blank</span></span><span class="brx">[</span>line<span class="brx">]</span><span class="cs">\hrule</span><span class="cs"><span class="documentcs">\blank</span></span><span class="brx">[</span>line<span class="brx">]</span>

<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span>First section<span class="brx">]</span>

   <span class="cs"><span class="documentcs">\startsubsection</span></span><span class="brx">[</span>title<span class="brx">=</span>First subsection<span class="brx">]</span>
      Lorem ipsum <span class="cs">\dots</span>
   <span class="cs"><span class="documentcs">\stopsubsection</span></span>

   <span class="cs"><span class="documentcs">\startsubsection</span></span><span class="brx">[</span>title<span class="brx">=</span>Second subsection<span class="brx">]</span>
      Lorem ipsum <span class="cs">\dots</span>
   <span class="cs"><span class="documentcs">\stopsubsection</span></span>

<span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span>Second section<span class="brx">]</span>

   <span class="cs"><span class="documentcs">\startsubsection</span></span><span class="brx">[</span>title<span class="brx">=</span>First subsection<span class="brx">]</span>
      Lorem ipsum <span class="cs">\dots</span>
   <span class="cs"><span class="documentcs">\stopsubsection</span></span>

<span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="874" src="../wikiteximage/c3f9c971da62e92219d897faf9ec1fa6.webp" width="614">
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Use_the_margin">
      Use the margin
     </span>
    </h2>
    <h3>
     <span class="mw-headline" id="Number_in_the_margin">
      Number in the margin
     </span>
    </h3>
    <p>This very simple example shows how to start a title within the margin, rather than at the text&rsquo;s edge
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>
<span class="cs"><span class="documentcs">\showframe</span></span>
<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span><span class="brx">[</span>alternative<span class="brx">=</span>margin<span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Sample chapter<span class="br">}</span><span class="brx">]</span>
Number is in margin, not at text edge.
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/333e45afb5d0bf3849781ffe79bd41f0.webp" width="438">
     </li>
    </ul>
    <h3>
     <span class="mw-headline" id="Headline_in_the_margin">
      Headline in the margin
     </span>
    </h3>
    <p>Source <a class="external text" href="https://tex.stackexchange.com/questions/415304/remove-indentation-of-first%7C" rel="nofollow">on tex.stackexchange</a>
</p>
    <p><i>The margintext alternative is mentioned in the command reference <a class="external autonumber" href="http://www.pragma-ade.nl/general/qrcs/setup-en.pdf" rel="nofollow">[1]</a>).</i>
</p>
    <p>To raise the position of the first line of the margin text you can use the <code>dy</code> key for <tt><a href="../Command/setupmargindata.html" title="Command/setupmargindata">\setupmargindata</a></tt> (<code>\setupmargindata[margintext:section][dy=-2pt]</code>). &ndash; Wolfgang Schuster - Commented Feb 14, 2018<i></i>
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A7<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuplayout</span></span>
  <span class="brx">[</span>leftmargin<span class="brx">=</span>1.5cm,
   backspace<span class="brx">=</span>1.75cm,
   width<span class="brx">=</span>5cm<span class="brx">]</span>
<span class="cs"><span class="documentcs">\showframe</span></span><span class="brx">[</span>text<span class="brx">]</span> <span class="brx">[</span>leftmargin,text<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupmargindata</span></span>
  <span class="brx">[</span>margintext:section<span class="brx">]</span>
  <span class="brx">[</span>align<span class="brx">=</span><span class="br">{</span>flushleft,nothyphenated,verytolerant<span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
  <span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>alternative<span class="brx">=</span>margintext,
   style<span class="brx">=</span><span class="cs">\sc</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>First<span class="cs">\\</span>Subject<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\input</span></span> ward
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Second<span class="cs">\\</span>Subject<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\input</span></span> ward
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="620" src="../wikiteximage/d6537491b0c4eee657b50a67f8a2f76d.webp" width="438">
     </li>
    </ul>
    <h3>
     <span id="Headline_in_the_margin_(2003)">
     </span>
     <span class="mw-headline" id="Headline_in_the_margin_.282003.29">
      Headline in the margin (2003)
     </span>
    </h3>
    <p>It is sometimes wanted to place the title of a section/subject etc in the margin next to the section text (instead of above it).
This is achieved by the following setup:
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A7<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuplayout</span></span>
  <span class="brx">[</span>leftmargin<span class="brx">=</span>1.5cm,
   backspace<span class="brx">=</span>1.75cm,
   width<span class="brx">=</span>5cm<span class="brx">]</span>
<span class="cs"><span class="documentcs">\showframe</span></span><span class="brx">[</span>text<span class="brx">]</span> <span class="brx">[</span>leftmargin,text<span class="brx">]</span>

<span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\MyHead</span><span class="br">{</span><span class="cs"><span class="documentcs">\inmargin</span></span><span class="br">{</span><span class="brx">#</span>1 <span class="brx">#</span>2<span class="br">}</span><span class="br">}</span>
<span class="cs"><span class="stylecs">\setuphead</span></span>
  <span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>alternative<span class="brx">=</span>text,
   style<span class="brx">=</span><span class="cs">\sc</span>,
   distance<span class="brx">=</span>0pt,
   command<span class="brx">=</span><span class="cs">\MyHead</span>,<span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>First<span class="cs">\\</span>Subject<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\input</span></span> ward
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Second<span class="cs">\\</span>Subject<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\input</span></span> ward
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="620" src="../wikiteximage/2b609bbfcf9b13889d5873fa98e1c37e.webp" width="438">
     </li>
    </ul>
    <p>See <a class="external text" href="http://www.ntg.nl/pipermail/ntg-context/2003/002053.html" rel="nofollow">the mailing list thread (2003)</a> for more on this.
</p>
    <h2>
     <span class="mw-headline" id="Numbering_and_text_on_separate_lines">
      Numbering and text on separate lines
     </span>
    </h2>
    <p>To have the chapter title simply in a new line, a new command needs to be defined that takes care of this. It needs to be wrapped in <tt><a href="../Command/framed.html" title="Command/framed">\framed</a></tt>.
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuplabeltext</span></span> <span class="brx">[</span>en<span class="brx">]</span> <span class="brx">[</span>section<span class="brx">=</span>Section~<span class="brx">]</span>

<span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\MySection</span><span class="br">{</span><span class="comment">%</span>
<span class="cs"><span class="documentcs">\framed</span></span>
  <span class="brx">[</span>frame<span class="brx">=</span>off,
   width<span class="brx">=</span>broad,
   align<span class="brx">=</span>flushleft<span class="brx">]</span>
  <span class="br">{</span><span class="brx">#</span>1<span class="cs">\\</span><span class="brx">#</span>2<span class="br">}</span><span class="br">}</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
  <span class="brx">[</span>section<span class="brx">]</span> 
  <span class="brx">[</span>command<span class="brx">=</span><span class="cs">\MySection</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Foo Bar<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/c8661a7d26139942be8a19d980ae52ca.webp" width="438">
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Section_label_in_the_headline">
      Section label in the headline
     </span>
    </h2>
    <p>This example illustrates expanded chapter titles with <tt><a class="mw-redirect" href="../Command/_labeltext.html" title="Command/headtext">\headtext</a></tt>. You need to define the text with <tt><a class="mw-redirect" href="../Command/_setuplabeltext.html" title="Command/setupheadtext">\setupheadtext</a></tt> or <tt><a class="mw-redirect" href="../Command/_setuplabeltext.html" title="Command/setuplabeltext">\setuplabeltext</a></tt> as above.
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>

<span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\MySection</span><span class="br">{</span><span class="comment">%</span>
<span class="cs"><span class="documentcs">\framed</span></span>
  <span class="brx">[</span>frame<span class="brx">=</span>off,
   bottomframe<span class="brx">=</span>on,
   topframe<span class="brx">=</span>on<span class="brx">]</span>
<span class="br">{</span><span class="cs">\vbox</span><span class="br">{</span><span class="brx">#</span>1<span class="cs"><span class="documentcs">\blank</span></span><span class="brx">#</span>2<span class="br">}</span><span class="br">}</span><span class="br">}</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
  <span class="brx">[</span>section<span class="brx">]</span> 
  <span class="brx">[</span>command<span class="brx">=</span><span class="cs">\MySection</span>,
   style<span class="brx">=</span><span class="br">{</span><span class="cs">\ss</span><span class="cs">\bfa</span><span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Foo Bar<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/50a5268958827fa0320b70f508da4460.webp" width="438">
     </li>
    </ul>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>

<span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\MySection</span><span class="br">{</span><span class="comment">%</span>
<span class="cs"><span class="documentcs">\framed</span></span>
  <span class="brx">[</span>frame<span class="brx">=</span>off,
   bottomframe<span class="brx">=</span>on,
   topframe<span class="brx">=</span>on<span class="brx">]</span>
<span class="br">{</span><span class="cs">\vbox</span><span class="br">{</span><span class="cs"><span class="stylecs">\headtext</span></span><span class="br">{</span>section<span class="br">}</span> <span class="brx">#</span>1    <span class="comment">% HERE </span>
<span class="cs"><span class="documentcs">\blank</span></span><span class="brx">#</span>2<span class="br">}</span><span class="br">}</span><span class="br">}</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
  <span class="brx">[</span>section<span class="brx">]</span> 
  <span class="brx">[</span>command<span class="brx">=</span><span class="cs">\MySection</span>,
   style<span class="brx">=</span><span class="br">{</span><span class="cs">\ss</span><span class="cs">\bfa</span><span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="stylecs">\setupheadtext</span></span><span class="brx">[</span>section<span class="brx">=</span>Section<span class="brx">]</span> <span class="comment">% HERE</span>
<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Foo Bar<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/a6f908c0fc8f128b2b9210db088c6096.webp" width="438">
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Headline_with_an_enlarged_shadow">
      Headline with an enlarged shadow
     </span>
    </h2>
    <p>This is an example of chapter headings with an enlarged shadow behind them, based on <a class="external text" href="http://archive.contextgarden.net/message/20041020.100630.d531bb1d.en.html" rel="nofollow">a solution by Hans (2004)</a>.
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>
<span class="cs"><span class="stylecs">\mainlanguage</span></span><span class="brx">[</span>fr<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setupcolors</span></span><span class="brx">[</span>state<span class="brx">=</span>start<span class="brx">]</span>

<span class="cs"><span class="stylecs">\definefont</span></span>
  <span class="brx">[</span>BigFontOne<span class="brx">]</span>  
  <span class="brx">[</span>Regular sa 3<span class="brx">]</span>      <span class="comment">%RegularSlanted sa 3(ori)</span>
                      <span class="comment">%Sans sa 3:don't work (pb accents)</span>
<span class="cs"><span class="stylecs">\definefont</span></span>
  <span class="brx">[</span>BigFontTwo<span class="brx">]</span>
  <span class="brx">[</span>RegularBold sa 2<span class="brx">]</span>  <span class="comment">%RegularSlanted</span>

<span class="cs"><span class="stylecs">\definecolor</span></span>
  <span class="brx">[</span>BigColorOne<span class="brx">]</span>
  <span class="brx">[</span>r<span class="brx">=</span>.86,g<span class="brx">=</span>.850,b<span class="brx">=</span>.54<span class="brx">]</span>
<span class="cs"><span class="stylecs">\definecolor</span></span>
  <span class="brx">[</span>BigColorTwo<span class="brx">]</span>
  <span class="brx">[</span>r<span class="brx">=</span>.43,g<span class="brx">=</span>.425,b<span class="brx">=</span>.27<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
   <span class="brx">[</span>chapter<span class="brx">]</span>
   <span class="brx">[</span>textcommand<span class="brx">=</span><span class="cs">\MyChapterText</span>,
    color<span class="brx">=</span>BigColorTwo,
    style<span class="brx">=</span><span class="cs">\BigFontTwo</span><span class="brx">]</span>

<span class="cs">\def</span><span class="cs">\MyChapterText</span><span class="brx">#</span>1<span class="br">{</span><span class="comment">%</span>
<span class="cs"><span class="systemcs">\rlap</span></span><span class="br">{</span><span class="cs">\BigFontOne</span><span class="cs">\BigColorOne</span><span class="brx">#</span>1<span class="br">}</span><span class="cs">\kern</span>15pt<span class="brx">#</span>1<span class="br">}</span>

<span class="cs"><span class="documentcs">\starttext</span></span>

<span class="cs"><span class="documentcs">\startchapter</span></span>
  <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Question<span class="br">}</span>,
   reference<span class="brx">=</span><span class="br">{</span>chap:ques<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopchapter</span></span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/76520018b9a6d66e5bec79d72200735f.webp" width="438">
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Completely_replace_the_text_and_chapter_number_with_an_image">
      Completely replace the text and chapter number with an image
     </span>
    </h2>
    <p>This example shows how to completely replace the chapter text and number by an image:
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A7<span class="brx">]</span>

<span class="cs"><span class="stylecs">\useexternalfigure</span></span>
  <span class="brx">[</span>section-1<span class="brx">]</span>
  <span class="brx">[</span>cow<span class="brx">]</span>
  <span class="brx">[</span>width<span class="brx">=</span>5cm,height<span class="brx">=</span>1cm<span class="brx">]</span>
<span class="cs"><span class="stylecs">\useexternalfigure</span></span>
  <span class="brx">[</span>section-2<span class="brx">]</span>
  <span class="brx">[</span>mill.png<span class="brx">]</span>
  <span class="brx">[</span>width<span class="brx">=</span>5cm,height<span class="brx">=</span>1cm<span class="brx">]</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
   <span class="brx">[</span>section<span class="brx">]</span>
   <span class="brx">[</span>command<span class="brx">=</span><span class="cs">\MySectionCommand</span><span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuphead</span></span> 
   <span class="brx">[</span>subsection<span class="brx">]</span>
   <span class="brx">[</span>command<span class="brx">=</span><span class="brx">]</span>   <span class="comment">% to prevent inheritance from section </span>

<span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\MySectionCommand</span><span class="comment">%</span>
   <span class="br">{</span><span class="cs"><span class="documentcs">\externalfigure</span></span><span class="brx">[</span>section-<span class="cs"><span class="systemcs">\namedheadnumber</span></span><span class="br">{</span>section<span class="br">}</span><span class="brx">]</span><span class="br">}</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
Text.
<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>One<span class="br">}</span><span class="brx">]</span>
  <span class="cs"><span class="documentcs">\startsubsection</span></span>
    <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>First subsection of Section One<span class="br">}</span><span class="brx">]</span>
  <span class="cs"><span class="documentcs">\stopsubsection</span></span>
<span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="documentcs">\startsection</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Two<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="620" src="../wikiteximage/76dd25a25b06a058e67fd9de20c17e09.webp" width="438">
     </li>
    </ul>
    <p>There are a few snags though. MkII "forgets" to put the chapter in the
TOC. So you have to set the <tt>deeptextcommand</tt> and
<tt>deepnumbercommand</tt> separately instead (thus retaining the
command that puts the chapter in the TOC), rather than setting the
overall <tt>command</tt>, if you need a complete TOC.
</p>
    <pre class="tex"><span class="cs"><span class="stylecs">\setuphead</span></span>
    <span class="brx">[</span>chapter<span class="brx">]</span>
    <span class="brx">[</span>deeptextcommand<span class="brx">=</span><span class="cs">\MyChapterTextCommand</span>,
     deepnumbercommand<span class="brx">=</span><span class="cs"><span class="systemcs">\gobbleoneargument</span></span><span class="brx">]</span>      <span class="comment">% hide chapter number</span>

<span class="cs">\def</span><span class="cs">\MyChapterTextCommand</span><span class="brx">#</span>1<span class="comment">%</span>
    <span class="br">{</span><span class="cs"><span class="documentcs">\externalfigure</span></span><span class="brx">[</span>chapter-<span class="cs"><span class="systemcs">\currentheadnumber</span></span><span class="brx">]</span><span class="brx">[</span>height<span class="brx">=</span>5cm<span class="brx">]</span><span class="br">}</span>
</pre>
    <p><a class="external text" href="http://archive.contextgarden.net/message/20050519.215526.df7c5cd1.html" rel="nofollow">archive.contextgarden.net (2005)</a> 
</p>
    <p>Users of MkIV can safely rely on <tt>command</tt> and don't have to bother with the <tt>deep...command</tt> variants. However, <tt><a href="../Command/currentheadnumber.html" title="Command/currentheadnumber">\currentheadnumber</a></tt> does not seem to return anything but 0. Thus, the following code is required to define <tt>\MyChapterCommand</tt> when using MkIV:
</p>
    <pre class="tex"><span class="cs">\def</span><span class="cs">\MyChapterCommand</span><span class="brx">#</span>1<span class="brx">#</span>2<span class="comment">%</span>
   <span class="br">{</span><span class="cs"><span class="documentcs">\externalfigure</span></span><span class="brx">[</span>chapter-<span class="cs"><span class="systemcs">\namedheadnumber</span></span><span class="br">{</span>chapter<span class="br">}</span><span class="brx">]</span><span class="brx">[</span>height<span class="brx">=</span>5cm<span class="brx">]</span><span class="br">}</span>
</pre>
    <p><a class="external text" href="http://archive.contextgarden.net/message/20100817.102859.206d858e.en.html" rel="nofollow">archive.contextgarden.net (2010)</a> 
</p>
    <h2>
     <span class="mw-headline" id="More_elaborate_headline_composition">
      More elaborate headline composition
     </span>
    </h2>
    <table style="background-color:#ddddee;color:#000000;border:1px solid #606060;margin:1em 5% 1em 5%;">
     <tbody>
      <tr>
       <td style="padding:0.5em 0.5em;"><ul class="demo"><li class="rendering"><img height="48" src="../wikiteximage/d8db8740e408c0191e8d08a98e7da5fa.webp" width="31"></li></ul><br>
</td>
       <td style="padding:0.5em 0.5em;"><b>TODO:</b> a more attractive example using similar features <i>(See: <a href="../Category:ToDo.html" title="Category:ToDo">To-Do List</a>)</i>
</td>
      </tr>
     </tbody>
    </table>
    <ul class="demo">
     <li class="code">
      <pre class="tex">   <span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A7<span class="brx">]</span>
   <span class="cs"><span class="stylecs">\setupcolors</span></span><span class="brx">[</span>state<span class="brx">=</span>start<span class="brx">]</span>
   <span class="cs"><span class="stylecs">\startuseMPgraphic</span></span><span class="br">{</span>HeaderDeco<span class="br">}</span>
           numeric w, h, repeats;
           path p<span class="brx">[</span><span class="brx">]</span>;
           w&nbsp;:<span class="brx">=</span> OverlayWidth&nbsp;; h&nbsp;:<span class="brx">=</span> OverlayHeight&nbsp;;
           repeats&nbsp;:<span class="brx">=</span> abs<span class="brx">(</span>TextWidth/BodyFontSize<span class="brx">)</span>;
           p<span class="brx">[</span>1<span class="brx">]</span>&nbsp;:<span class="brx">=</span> unitsquare xscaled w yscaled h&nbsp;;
           draw p<span class="brx">[</span>1<span class="brx">]</span> withcolor white;
           p<span class="brx">[</span>2<span class="brx">]</span>&nbsp;:<span class="brx">=</span> fullcircle scaled BodyFontSize;
           p<span class="brx">[</span>3<span class="brx">]</span>&nbsp;:<span class="brx">=</span> fullcircle scaled .25BodyFontSize;
           draw p<span class="brx">[</span>2<span class="brx">]</span> shifted <span class="brx">(</span>.5BodyFontSize,0<span class="brx">)</span>;
           for i <span class="brx">=</span> 1 upto repeats:
               if odd i&nbsp;:
                   filldraw p<span class="brx">[</span>3<span class="brx">]</span> shifted <span class="brx">(</span>i*BodyFontSize+.5BodyFontSize,0<span class="brx">)</span>;
               else&nbsp;:
                   draw p<span class="brx">[</span>2<span class="brx">]</span> shifted <span class="brx">(</span>i*BodyFontSize+.5BodyFontSize,0<span class="brx">)</span>;
           fi;
          endfor;
   <span class="cs"><span class="stylecs">\stopuseMPgraphic</span></span>

   <span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>chapter<span class="brx">]</span><span class="brx">[</span>command<span class="brx">=</span><span class="cs">\Myheader</span><span class="brx">]</span>
   <span class="cs"><span class="stylecs">\setupheadtext</span></span>
         <span class="brx">[</span>chapter<span class="brx">=</span>Chapitre<span class="brx">]</span>
   <span class="cs"><span class="stylecs">\defineoverlay</span></span><span class="brx">[</span>HeaderDeco<span class="brx">]</span><span class="brx">[</span><span class="cs"><span class="stylecs">\uniqueMPgraphic</span></span><span class="br">{</span>HeaderDeco<span class="br">}</span><span class="brx">]</span>

   <span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\Myheader</span><span class="br">{</span><span class="comment">%</span>
       <span class="cs"><span class="documentcs">\framedtext</span></span>
           <span class="brx">[</span>width<span class="brx">=</span> <span class="cs"><span class="systemcs">\overlaywidth</span></span>,
           height<span class="brx">=</span>6<span class="cs"><span class="systemcs">\bodyfontsize</span></span>,
           background<span class="brx">=</span><span class="br">{</span>foreground,HeaderDeco<span class="br">}</span>,
           offset<span class="brx">=</span>0pt,
           strut<span class="brx">=</span>no,
           frame<span class="brx">=</span>off,
           align<span class="brx">=</span>middle<span class="brx">]</span><span class="br">{</span><span class="comment">%</span>
               <span class="cs"><span class="stylecs">\headtext</span></span><span class="br">{</span>chapter<span class="br">}</span> <span class="brx">#</span>1
               <span class="cs"><span class="documentcs">\blank</span></span><span class="brx">[</span>small<span class="brx">]</span>
               <span class="brx">#</span>2<span class="br">}</span><span class="br">}</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
   <span class="cs"><span class="documentcs">\chapter</span></span><span class="br">{</span>Here we go!<span class="br">}</span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="620" src="../wikiteximage/2713c175b0efb16c420c357753754eb3.webp" width="438">
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Title_page_with_special_background">
      Title page with special background
     </span>
    </h2>
    <p>If you want the title page of every chapter to have a special background (different from the background of normal pages), here&rsquo;s a very effective trick that Hans has provided on the mailing list. In addition, this will give every chapter its own color scheme: 
</p>
    <ul class="demo">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\definepapersize</span></span><span class="brx">[</span>sheet<span class="brx">]</span><span class="brx">[</span>width<span class="brx">=</span>104mm,height<span class="brx">=</span>148mm<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8<span class="brx">]</span><span class="brx">[</span>sheet<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuppaper</span></span><span class="brx">[</span>nx<span class="brx">=</span>2,ny<span class="brx">=</span>2<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuparranging</span></span><span class="brx">[</span>XY<span class="brx">]</span>
<span class="cs"><span class="documentcs">\showframe</span></span><span class="brx">[</span>edge<span class="brx">]</span>

<span class="cs"><span class="stylecs">\startMPinclusions</span></span>
    numeric MyTitlePageDone<span class="brx">[</span><span class="brx">]</span>&nbsp;;
<span class="cs"><span class="stylecs">\stopMPinclusions</span></span>

<span class="cs"><span class="stylecs">\startuseMPgraphic</span></span><span class="br">{</span>background:normal<span class="br">}</span>
  StartPage&nbsp;;
    fill <span class="brx">(</span>topboundary Page -- cycle<span class="brx">)</span> enlarged<span class="brx">(</span>0,5mm<span class="brx">)</span> 
    shifted <span class="brx">(</span>0,-5mm<span class="brx">)</span> withcolor darkred&nbsp;;
  StopPage&nbsp;;
<span class="cs"><span class="stylecs">\stopuseMPgraphic</span></span>

<span class="cs"><span class="stylecs">\defineoverlay</span></span>
  <span class="brx">[</span>background:normal<span class="brx">]</span>
  <span class="brx">[</span><span class="cs"><span class="stylecs">\useMPgraphic</span></span><span class="br">{</span>background:normal<span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="stylecs">\startuseMPgraphic</span></span><span class="br">{</span>background:title<span class="br">}</span>
  if unknown MyTitlePageDone.<span class="cs"><span class="systemcs">\namedstructureuservariable</span></span><span class="br">{</span>chapter<span class="br">}</span><span class="br">{</span>mycolor<span class="br">}</span>&nbsp;:
    StartPage&nbsp;;
       fill <span class="brx">(</span><span class="brx">(</span>topboundary Page --cycle<span class="brx">)</span> enlarged<span class="brx">(</span>0,5mm<span class="brx">)</span><span class="brx">)</span> shifted <span class="brx">(</span>0,-20mm<span class="brx">)</span>
            withcolor <span class="cs"><span class="stylecs">\MPcolor</span></span><span class="br">{</span>color:title:<span class="cs"><span class="systemcs">\namedstructureuservariable</span></span><span class="br">{</span>chapter<span class="br">}</span><span class="br">{</span>mycolor<span class="br">}</span><span class="br">}</span>&nbsp;;
    StopPage&nbsp;;
    MyTitlePageDone.<span class="cs"><span class="systemcs">\namedstructureuservariable</span></span><span class="br">{</span>chapter<span class="br">}</span><span class="br">{</span>mycolor<span class="br">}</span>&nbsp;:<span class="brx">=</span> 1&nbsp;;
  fi&nbsp;;
<span class="cs"><span class="stylecs">\stopuseMPgraphic</span></span>

<span class="cs"><span class="stylecs">\defineoverlay</span></span>
  <span class="brx">[</span>background:title<span class="brx">]</span>
  <span class="brx">[</span><span class="cs"><span class="stylecs">\useMPgraphic</span></span><span class="br">{</span>background:title<span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="stylecs">\setupbackgrounds</span></span>
  <span class="brx">[</span>page<span class="brx">]</span>
  <span class="brx">[</span>background<span class="brx">=</span><span class="br">{</span>background:normal,background:title<span class="br">}</span><span class="brx">]</span>

<span class="cs"><span class="stylecs">\definecolor</span></span> <span class="brx">[</span>color:title:one<span class="brx">]</span> <span class="brx">[</span>middlecyan<span class="brx">]</span>
<span class="cs"><span class="stylecs">\definecolor</span></span> <span class="brx">[</span>color:title:two<span class="brx">]</span> <span class="brx">[</span>middleyellow<span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>

<span class="cs"><span class="documentcs">\startchapter</span></span><span class="brx">[</span>title<span class="brx">=</span>One<span class="brx">]</span><span class="brx">[</span>mycolor<span class="brx">=</span>one<span class="brx">]</span>
 <span class="cs"><span class="documentcs">\input</span></span> ward <span class="cs"><span class="documentcs">\page</span></span> 
 <span class="cs"><span class="documentcs">\input</span></span> knuth
<span class="cs"><span class="documentcs">\stopchapter</span></span>
<span class="cs"><span class="documentcs">\startchapter</span></span><span class="brx">[</span>title<span class="brx">=</span>Two<span class="brx">]</span><span class="brx">[</span>mycolor<span class="brx">=</span>two<span class="brx">]</span>
 <span class="cs"><span class="documentcs">\input</span></span> tufte
 <span class="cs"><span class="documentcs">\page</span></span> 
 <span class="cs"><span class="documentcs">\input</span></span> knuth 
<span class="cs"><span class="documentcs">\stopchapter</span></span>

<span class="cs"><span class="documentcs">\stoptext</span></span>

</pre>
     </li>
     <li class="rendering">
      <img height="874" src="../wikiteximage/eccd674e315e2c6c10265b959aea3116.webp" width="614">
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Chapter_head_with_absolute_positioning_of_following_text">
      Chapter head with absolute positioning of following text
     </span>
    </h2>
    <p>No matter how many lines the chapter head runs to, the text will always start, e.g. 4cm below the top of the heading:
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A7<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setupbodyfont</span></span><span class="brx">[</span>8pt<span class="brx">]</span>

<span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\MyChapterCommand</span><span class="br">{</span><span class="comment">%</span>
<span class="cs">\vbox</span> to 4cm<span class="cs">\bgroup</span>
<span class="br">{</span><span class="brx">#</span>1<span class="cs">\hskip</span>.75em <span class="brx">#</span>2<span class="br">}</span>
<span class="cs">\vss</span><span class="cs">\egroup</span><span class="br">}</span>

<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>chapter<span class="brx">]</span>
  <span class="brx">[</span>header<span class="brx">=</span>nomarking, 
   command<span class="brx">=</span><span class="cs">\MyChapterCommand</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>

<span class="cs"><span class="documentcs">\startchapter</span></span><span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>test<span class="br">}</span><span class="brx">]</span>
<span class="cs"><span class="documentcs">\input</span></span> tufte
<span class="cs"><span class="documentcs">\stopchapter</span></span>

<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="620" src="../wikiteximage/af2971247c937a76767e41ddd6024196.webp" width="438">
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Underlining_to_the_width_of_last_line_of_the_headline">
      Underlining to the width of last line of the headline
     </span>
    </h2>
    <p>A style called for section headings to be followed by a rule which extends only the width of the text. More tricky was the need to make sure that if the text ran onto another line, it was the length of the <i>last</i> line that was to be followed. 
</p>
    <p>Hans came up with this cleverness, showing two alternate ways of doing it:
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A7<span class="brx">]</span>

<span class="comment">% ---- First solution ----</span>

<span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\FirstSolution</span><span class="comment">%</span>
  <span class="br">{</span><span class="cs">\vbox</span><span class="cs">\bgroup</span>
   <span class="cs">\setbox</span>0<span class="cs">\hbox</span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
   <span class="cs">\hsize</span>.4<span class="cs">\textwidth</span>
   <span class="cs">\beginshapebox</span><span class="brx">#</span>2<span class="cs">\endshapebox</span>
   <span class="cs">\gdef</span><span class="cs">\SetLastLineWidth</span><span class="br">{</span><span class="cs">\xdef</span><span class="cs">\LastLineWidth</span><span class="br">{</span><span class="cs">\the</span><span class="cs">\wd</span><span class="cs">\scratchbox</span><span class="br">}</span><span class="br">}</span><span class="comment">%</span>
   <span class="cs"><span class="systemcs">\reshapebox</span></span>
     <span class="br">{</span><span class="cs">\setbox</span><span class="cs">\scratchbox</span><span class="cs">\hbox</span><span class="br">{</span><span class="cs">\unhbox</span><span class="cs">\shapebox</span><span class="br">}</span><span class="comment">%</span>
      <span class="cs">\SetLastLineWidth</span>
      <span class="cs">\globallet</span><span class="cs">\SetLastLineWidth</span><span class="cs">\relax</span>
      <span class="cs">\box</span><span class="cs">\scratchbox</span><span class="br">}</span><span class="comment">%</span>
   <span class="cs">\scratchdimen</span><span class="cs">\dimexpr</span><span class="cs">\wd</span>0+.25em+<span class="cs">\LastLineWidth</span><span class="cs">\relax</span>
<span class="comment">% \setbox2\ruledvbox   {\innerflushshapebox} </span>
<span class="comment">% why is correction needed</span>
   <span class="cs">\setbox</span>2<span class="cs">\vbox</span>        <span class="br">{</span><span class="cs">\vskip</span>-<span class="cs">\lineskip</span><span class="cs"><span class="systemcs">\innerflushshapebox</span></span><span class="br">}</span>
   <span class="cs">\setbox</span>0<span class="cs">\vbox</span> to <span class="cs">\ht</span>2<span class="br">{</span><span class="cs">\box</span>0<span class="br">}</span>
   <span class="cs">\hbox</span><span class="br">{</span><span class="cs">\box</span>0<span class="cs">\hskip</span>.25em<span class="cs">\box</span>2<span class="br">}</span>
   <span class="cs">\offinterlineskip</span>
   <span class="cs">\vskip</span>.25ex
   <span class="cs"><span class="documentcs">\blackrule</span></span><span class="brx">[</span>width<span class="brx">=</span><span class="cs">\scratchdimen</span>,height<span class="brx">=</span>1pt<span class="brx">]</span>
   <span class="cs">\egroup</span><span class="br">}</span>

<span class="comment">% ---- Second solution ----</span>

<span class="cs">\doglobal</span><span class="cs"><span class="systemcs">\newcounter</span></span><span class="cs">\NextLinePos</span>

<span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\SecondSolution</span><span class="comment">%</span>
  <span class="br">{</span><span class="cs">\vbox</span><span class="cs">\bgroup</span>
   <span class="cs">\hsize</span>.4<span class="cs">\textwidth</span>
   <span class="cs">\doglobal</span><span class="cs"><span class="systemcs">\increment</span></span><span class="cs">\NextLinePos</span>
   <span class="cs">\setbox</span><span class="cs">\scratchbox</span><span class="cs">\hbox</span><span class="br">{</span><span class="brx">#</span>1<span class="br">}</span>
   <span class="cs">\hbox</span><span class="br">{</span><span class="cs">\vtop</span><span class="br">{</span><span class="cs">\copy</span><span class="cs">\scratchbox</span><span class="br">}</span><span class="cs">\hskip</span>.25em<span class="cs">\vtop</span><span class="br">{</span><span class="brx">#</span>2<span class="br">}</span><span class="br">}</span><span class="comment">%</span>
   <span class="cs">\offinterlineskip</span>
   <span class="cs">\scratchdimen</span><span class="cs">\dimexpr</span><span class="cs">\wd</span><span class="cs">\scratchbox</span>+.25em+
     <span class="cs"><span class="systemcs">\MPx</span></span><span class="br">{</span>e:npl:<span class="cs">\NextLinePos</span><span class="br">}</span>-<span class="cs"><span class="systemcs">\MPx</span></span><span class="br">{</span>b:npl:<span class="cs">\NextLinePos</span><span class="br">}</span><span class="cs">\relax</span>
   <span class="cs">\vskip</span>.25ex
   <span class="cs"><span class="documentcs">\blackrule</span></span><span class="brx">[</span>width<span class="brx">=</span><span class="cs">\scratchdimen</span>,height<span class="brx">=</span>1pt<span class="brx">]</span>
   <span class="cs">\egroup</span><span class="br">}</span>

<span class="cs">\def</span><span class="cs">\DoSecondSolution</span><span class="brx">#</span>1<span class="comment">%</span>
  <span class="br">{</span><span class="cs"><span class="systemcs">\bpos</span></span><span class="br">{</span>npl:<span class="cs">\NextLinePos</span><span class="br">}</span><span class="brx">#</span>1<span class="cs"><span class="systemcs">\epos</span></span><span class="br">{</span>npl:<span class="cs">\NextLinePos</span><span class="br">}</span><span class="br">}</span>

<span class="comment">% ---- Trying it out solution ----</span>

<span class="comment">% \showstruts</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span><span class="brx">[</span>command<span class="brx">=</span><span class="cs">\FirstSolution</span><span class="brx">]</span>
    <span class="cs"><span class="documentcs">\section</span></span><span class="br">{</span>is this nice or not<span class="br">}</span>
    <span class="cs"><span class="documentcs">\section</span></span><span class="br">{</span>is this nice or not nice, that's the question<span class="br">}</span>

<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span><span class="brx">[</span>command<span class="brx">=</span><span class="cs">\SecondSolution</span>,deeptextcommand<span class="brx">=</span><span class="cs">\DoSecondSolution</span><span class="brx">]</span>
    <span class="cs"><span class="documentcs">\section</span></span><span class="br">{</span>is this nice or not<span class="br">}</span>
    <span class="cs"><span class="documentcs">\section</span></span><span class="br">{</span>is this nice or not nice, that's the question<span class="br">}</span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="620" src="../wikiteximage/3088be131a8d57b597caeba786cd7da8.webp" width="438">
     </li>
    </ul>
    <p>As if that wasn't enough, Taco pointed out that <tt><a class="new" href="../index.php?title=Command/lastlinewidth&action=edit&redlink=1.html" title="Command/lastlinewidth (page does not exist)">\lastlinewidth</a></tt>
is the easy route to finding the width of the last line. Use something like:
</p>
    <pre class="tex"><span class="cs">\optimizedisplayspacingtrue</span><span class="cs">\setlastlinewidth</span> <span class="comment">% core-mat macro</span>
<span class="cs">\global</span><span class="cs">\advance</span><span class="cs"><span class="systemcs">\lastlinewidth</span></span>-<span class="cs">\hangindent</span><span class="cs">\par</span> <span class="comment">% adjust</span>
<span class="cs"><span class="documentcs">\blackrule</span></span><span class="brx">[</span>width<span class="brx">=</span><span class="cs"><span class="systemcs">\lastlinewidth</span></span>,height<span class="brx">=</span>1pt<span class="brx">]</span>
</pre>
    <h2>
     <span class="mw-headline" id="Headline_including_bold_math">
      Headline including bold math
     </span>
    </h2>
    <p>When a section title is formatted in boldface text, this doesn't automatically typeset embedded math in bold.  This is probably a good thing, as many math fonts do not include all characters in boldface, and often authors use boldface to distinguish between different meanings (for instance, scalar and vector variables).  However, in some cases, it <i>is</i> desirable to format the math in the section titles in boldface.
</p>
    <p>Here a very simple example:
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuppapersize</span></span><span class="brx">[</span>A8,landscape<span class="brx">]</span>
<span class="cs"><span class="stylecs">\definetypeface</span></span>
  <span class="brx">[</span>boldmath<span class="brx">]</span> <span class="brx">[</span>mm<span class="brx">]</span>
  <span class="brx">[</span>boldmath<span class="brx">]</span> <span class="brx">[</span>latin-modern<span class="brx">]</span>
  <span class="brx">[</span>default<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuphead</span></span><span class="brx">[</span>section<span class="brx">]</span><span class="brx">[</span>style<span class="brx">=</span><span class="cs">\boldmath</span><span class="cs">\rm</span><span class="cs">\bfa</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\starttext</span></span>
<span class="cs"><span class="documentcs">\section</span></span><span class="br">{</span>Bold $a^2+b^2<span class="brx">=</span>c^2$ <span class="br">{</span><span class="cs"><span class="documentcs">\em</span></span> bla<span class="br">}</span><span class="br">}</span>
text: not bold $a^2+b^2<span class="brx">=</span>c^2$ <span class="br">{</span><span class="cs"><span class="documentcs">\em</span></span> bla<span class="br">}</span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="307" src="../wikiteximage/04d076f476a0922a50156f818893ab18.webp" width="438">
     </li>
    </ul>
    <!-- 
NewPP limit report
Cached time: 20260110084428
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 0.205 seconds
Real time usage: 1.008 seconds
Preprocessor visited node count: 483/1000000
Preprocessor generated node count: 0/1000000
Postexpand include size: 2429/2097152 bytes
Template argument size: 628/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip postexpand size: 63413/5000000 bytes
-->
    <!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  611.873      1 -total
  6.44%   39.381      1 Template:todo
  2.60%   15.922     20 Template:cmd
  1.96%   12.014      5 Template:code
-->
    <!-- Saved in parser cache with key wikidb16_33:pcache:idhash:851-1!canonical and timestamp 20260110084427 and revision id 39757
 -->
   </div>
  </article>
  <footer>
   <ul role="list">
    <li>
     <a href="../index.html">
      Home
     </a>
    </li>
    <li>
     Mirrored on 2026-01-10
    </li>
    <li>
     <a href="http://www.gnu.org/copyleft/fdl.html" rel="license">
      GFDL 1.2
     </a>
    </li>
    <li>
     <a href="https://wiki.contextgarden.net/Document_structure_and_headlines/Headlines_formatting">
      Original page
     </a>
    </li>
   </ul>
  </footer>
 </body>
</html>
