<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <link href="../style.css" rel="stylesheet">
  <link href="../favicon.ico" rel="icon" sizes="32x32">
  <title>
   Document layout and layers/Grid typesetting&mdash;ConTeXt Wiki Mirror
  </title>
  <link href="https://wiki.contextgarden.net/Document_layout_and_layers/Grid_typesetting" rel="canonical">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="#241504" name="theme-color">
  <meta content="light dark" name="color-scheme">
 </head>
 <body>
  <header>
   <h1 id="page-title">
    Document layout and layers/Grid typesetting
   </h1>
   <p>Unofficial <a href="https://wiki.contextgarden.net/">ConTeXt Wiki</a> mirror</p>
   <p>Last modified: <a href="https://wiki.contextgarden.net/index.php?curid=4936&diff=41870">2025-12-26</a>
        </p>
  </header>
  <article>
   <div class="mw-parser-output">
    <div class="toc" id="toc">
     <input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox">
     <div class="toctitle" dir="ltr" lang="en">
      <h2>
       Contents
      </h2>
      <span class="toctogglespan">
       <label class="toctogglelabel" for="toctogglecheckbox">
       </label>
      </span>
     </div>
     <ul>
      <li class="toclevel-1 tocsection-1">
       <a href="#Introduction">
        <span class="tocnumber">
         1
        </span>
        <span class="toctext">
         Introduction
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-2">
       <a href="#Enable_grid_typesetting">
        <span class="tocnumber">
         2
        </span>
        <span class="toctext">
         Enable grid typesetting
        </span>
       </a>
      </li>
      <li class="toclevel-1 tocsection-3">
       <a href="#Placing_titles_on_the_grid">
        <span class="tocnumber">
         3
        </span>
        <span class="toctext">
         Placing titles on the grid
        </span>
       </a>
       <ul>
        <li class="toclevel-2 tocsection-4">
         <a href="#Example">
          <span class="tocnumber">
           3.1
          </span>
          <span class="toctext">
           Example
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-5">
         <a href="#Adjusting_the_section_head_placement">
          <span class="tocnumber">
           3.2
          </span>
          <span class="toctext">
           Adjusting the section head placement
          </span>
         </a>
         <ul>
          <li class="toclevel-3 tocsection-6">
           <a href="#Example_2">
            <span class="tocnumber">
             3.2.1
            </span>
            <span class="toctext">
             Example
            </span>
           </a>
          </li>
         </ul>
        </li>
        <li class="toclevel-2 tocsection-7">
         <a href="#Example_3">
          <span class="tocnumber">
           3.3
          </span>
          <span class="toctext">
           Example
          </span>
         </a>
        </li>
       </ul>
      </li>
      <li class="toclevel-1 tocsection-8">
       <a href="#Typesetting_non_grid_aligned_content">
        <span class="tocnumber">
         4
        </span>
        <span class="toctext">
         Typesetting non grid aligned content
        </span>
       </a>
      </li>
     </ul>
    </div>
    <h2>
     <span class="mw-headline" id="Introduction">
      Introduction
     </span>
    </h2>
    <p>Grid typesetting ensures the same vertical position of typeset lines:
</p>
    <ul>
     <li>
      in case of multiple columns it ensures the same vertical position of adjacent lines
     </li>
     <li>
      in case of duplex printing it ensures the same vertical position of lines on front and back side of the page. This approach prevents disturbing the reader by dark tint between the lines if the medium is translucent.
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Enable_grid_typesetting">
      Enable grid typesetting
     </span>
    </h2>
    <p>Grid typesetting is enabled with <code>\setuplayout [grid=yes]</code> and visualized with <code>\showgrid</code>.
</p>
    <p>Alternative grid snapping methods are discussed in the description of
<a href="../Command/setuplayout#Grid_Setups.html" title="Command/setuplayout"><tt>\setuplayout</tt></a>, and also in <tt><a href="../Command/snaptogrid.html" title="Command/snaptogrid">\snaptogrid</a></tt> (to merge&nbsp;?)
</p>
    <h2>
     <span class="mw-headline" id="Placing_titles_on_the_grid">
      Placing titles on the grid
     </span>
    </h2>
    <p>As title font sizes and baseline distances differ from the body text, only the last baseline is placed on the grid. The baseline distance of preceding lines (in case of multi-line titles) is not affected by the grid settings.
</p>
    <h3>
     <span class="mw-headline" id="Example">
      Example
     </span>
    </h3>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuplayout</span></span> <span class="brx">[</span>grid<span class="brx">=</span>yes, width<span class="brx">=</span>12cm<span class="brx">]</span>
<span class="cs"><span class="stylecs">\definefont</span></span>  <span class="brx">[</span>BigFont<span class="brx">]</span>  
             <span class="brx">[</span>Bold at 20pt<span class="brx">]</span> <span class="brx">[</span>26pt<span class="brx">]</span>
<span class="cs"><span class="stylecs">\setuphead</span></span>   <span class="brx">[</span>section<span class="brx">]</span>  <span class="brx">[</span>style<span class="brx">=</span><span class="cs">\BigFont</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\showgrid</span></span>
<span class="cs"><span class="documentcs">\starttext</span></span>

  <span class="cs"><span class="documentcs">\startsection</span></span> <span class="brx">[</span>title<span class="brx">=</span>Lorem ipsum dolor<span class="brx">]</span>
    <span class="cs"><span class="documentcs">\input</span></span> ward
  <span class="cs"><span class="documentcs">\stopsection</span></span>

  <span class="cs"><span class="documentcs">\startsection</span></span> <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Lorem ipsum dolor
   sit amet consectetur adipisicing elit<span class="br">}</span><span class="brx">]</span>
    <span class="cs"><span class="documentcs">\input</span></span> ward
  <span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="1240" src="../wikiteximage/f0d64b0a395416dfcc78b83438d5eba2.webp" width="874">
     </li>
    </ul>
    <h3>
     <span class="mw-headline" id="Adjusting_the_section_head_placement">
      Adjusting the section head placement
     </span>
    </h3>
    <p>Lots of examples and the commands and options for head placement are provided in the manual <a class="external text" href="http://www.pragma-ade.nl/general/manuals/details.pdf" rel="nofollow">It's in the details!</a>. However, it is not covered how to place the <i>first</i> line of a multi-line structure head onto the grid. The solution is to frame the structure head and instruct to typeset the first line on the grid.
</p>
    <h4>
     <span class="mw-headline" id="Example_2">
      Example
     </span>
    </h4>
    <pre class="tex"><span class="comment">% macros=mkvi</span>
<span class="cs"><span class="stylecs">\setuplayout</span></span> <span class="brx">[</span>grid<span class="brx">=</span>yes<span class="brx">]</span>
<span class="cs"><span class="stylecs">\definefont</span></span>  <span class="brx">[</span>BigFont<span class="brx">]</span>  <span class="brx">[</span>Bold at 20pt<span class="brx">]</span> <span class="brx">[</span>24pt<span class="brx">]</span>

<span class="cs"><span class="systemcs">\unprotect</span></span>
<span class="cs">\newdimen</span><span class="cs">\section_frame_width</span>
<span class="cs">\unexpanded</span><span class="cs">\def</span><span class="cs">\section_command</span><span class="brx">#</span>number<span class="brx">#</span>title<span class="br">{</span><span class="comment">%</span>
  <span class="cs">\section_frame_width</span><span class="cs">\hsize</span>             <span class="comment">% we need to calculate the remaining</span>
  <span class="cs">\setbox</span><span class="cs">\scratchbox</span><span class="cs">\hbox</span><span class="br">{</span><span class="brx">#</span>number<span class="cs"><span class="stylecs">\space</span></span><span class="br">}</span> <span class="comment">% horizontal space</span>
  <span class="cs">\advance</span><span class="cs">\section_frame_width</span> by -<span class="cs">\wd</span><span class="cs">\scratchbox</span>
  <span class="brx">#</span>number<span class="cs"><span class="stylecs">\space</span></span>
  <span class="cs"><span class="documentcs">\framed</span></span> <span class="brx">[</span>
       width<span class="brx">=</span><span class="cs">\section_frame_width</span>,
      before<span class="brx">=</span>,
    location<span class="brx">=</span>top,
       align<span class="brx">=</span>right,<span class="brx">]</span><span class="br">{</span><span class="brx">#</span>title<span class="br">}</span><span class="comment">%</span>
<span class="br">}</span>

<span class="cs"><span class="stylecs">\setuphead</span></span> <span class="brx">[</span>section<span class="brx">]</span> <span class="brx">[</span>
    style<span class="brx">=</span><span class="cs">\BigFont</span>,
    after<span class="brx">=</span>,
   before<span class="brx">=</span><span class="br">{</span><span class="cs"><span class="documentcs">\blank</span></span><span class="brx">[</span>2*line<span class="brx">]</span><span class="br">}</span>,
  command<span class="brx">=</span><span class="cs">\section_command</span>,
<span class="brx">]</span>
<span class="cs">\protect</span>

<span class="cs"><span class="documentcs">\showgrid</span></span>
<span class="cs"><span class="documentcs">\starttext</span></span>
  <span class="cs"><span class="documentcs">\startsection</span></span> <span class="brx">[</span>title<span class="brx">=</span>Lorem ipsum dolor<span class="brx">]</span>
    <span class="cs"><span class="documentcs">\input</span></span> ward
  <span class="cs"><span class="documentcs">\stopsection</span></span>

  <span class="cs"><span class="systemcs">\dorecurse</span></span><span class="br">{</span>4<span class="br">}</span><span class="br">{</span><span class="comment">%</span>
    <span class="cs"><span class="documentcs">\startsection</span></span> <span class="brx">[</span>title<span class="brx">=</span>Lorem ipsum dolor sit amet consectetur adipisicing elit<span class="brx">]</span>
      <span class="cs"><span class="documentcs">\input</span></span> ward
    <span class="cs"><span class="documentcs">\stopsection</span></span><span class="br">}</span>
<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
    <h3>
     <span class="mw-headline" id="Example_3">
      Example
     </span>
    </h3>
    <p>The <a href="../Text_blocks/Environments/Frames#Location_parameter.html" title="Text blocks/Environments/Frames">location parameter</a> of <tt><a href="../Command/defineframed.html" title="Command/defineframed">\defineframed</a></tt> ( or <tt><a href="../Command/framed.html" title="Command/framed">\framed</a></tt> etc.) allows to specify the result you want (combined with parameters like <code>before</code>, <code>after</code>, <code>strut</code>)
</p>
    <ul class="demosbs">
     <li class="code">
      <pre class="tex"><span class="cs"><span class="stylecs">\setuplayout</span></span> <span class="brx">[</span>grid<span class="brx">=</span>yes, width<span class="brx">=</span>12cm<span class="brx">]</span>
<span class="cs"><span class="stylecs">\definefont</span></span>  <span class="brx">[</span>BigFont<span class="brx">]</span>  
             <span class="brx">[</span>Bold at 20pt<span class="brx">]</span> <span class="brx">[</span>26pt<span class="brx">]</span>
<span class="cs"><span class="stylecs">\defineframed</span></span>
  <span class="brx">[</span>MyFrame<span class="brx">]</span>
  <span class="brx">[</span>frame<span class="brx">=</span>off,
   offset<span class="brx">=</span>0pt,
   rulethickness<span class="brx">=</span>0pt,
   width<span class="brx">=</span>broad,
   align<span class="brx">=</span>flushleft,
   before<span class="brx">=</span>,
   after<span class="brx">=</span>,
   strut<span class="brx">=</span>yes,
   location<span class="brx">=</span>top,<span class="brx">]</span>

<span class="cs"><span class="systemcs">\define</span></span><span class="brx">[</span>2<span class="brx">]</span><span class="cs">\MySection</span><span class="br">{</span><span class="comment">%</span>
  <span class="cs">\MyFrame</span><span class="br">{</span><span class="brx">#</span>1 <span class="brx">#</span>2<span class="br">}</span><span class="br">}</span>

<span class="cs"><span class="stylecs">\setuphead</span></span>
  <span class="brx">[</span>section<span class="brx">]</span>
  <span class="brx">[</span>style<span class="brx">=</span><span class="cs">\BigFont</span>,
  before<span class="brx">=</span>,
  after<span class="brx">=</span>,
  command<span class="brx">=</span><span class="cs">\MySection</span><span class="brx">]</span>

<span class="cs"><span class="documentcs">\showgrid</span></span>
<span class="cs"><span class="documentcs">\starttext</span></span>

  <span class="cs"><span class="documentcs">\startsection</span></span> <span class="brx">[</span>title<span class="brx">=</span>Lorem ipsum dolor<span class="brx">]</span>
    <span class="cs"><span class="documentcs">\input</span></span> ward
  <span class="cs"><span class="documentcs">\stopsection</span></span>

  <span class="cs"><span class="documentcs">\startsection</span></span> <span class="brx">[</span>title<span class="brx">=</span><span class="br">{</span>Lorem ipsum dolor
   sit amet consectetur adipisicing elit<span class="br">}</span><span class="brx">]</span>
    <span class="cs"><span class="documentcs">\input</span></span> ward
  <span class="cs"><span class="documentcs">\stopsection</span></span>

<span class="cs"><span class="documentcs">\stoptext</span></span>
</pre>
     </li>
     <li class="rendering">
      <img height="1240" src="../wikiteximage/acfcb5c1942bbdd135d83e80d04e4c30.webp" width="874">
     </li>
    </ul>
    <h2>
     <span class="mw-headline" id="Typesetting_non_grid_aligned_content">
      Typesetting non grid aligned content
     </span>
    </h2>
    <p>See the <a class="external text" href="http://context.aanhet.net/svn/contextman/context-reference/en/co-pagedesign.pdf" rel="nofollow">page design chapter</a> of the new reference manual!
</p>
    <p>You can wrap that whole stuff inside
</p>
    <pre class="tex"><span class="cs"><span class="documentcs">\startlinecorrection</span></span>
...
<span class="cs"><span class="documentcs">\stoplinecorrection</span></span>
</pre>
    <p>The stuff inside that environment will not be grid-aligned, but the final resulting box will be.
</p>
    <table style="background-color:#ddddee;color:#000000;border:1px solid #606060;margin:1em 5% 1em 5%;">
     <tbody>
      <tr>
       <td style="padding:0.5em 0.5em;"><ul class="demo"><li class="rendering"><img height="48" src="../wikiteximage/d8db8740e408c0191e8d08a98e7da5fa.webp" width="31"></li></ul><br>
</td>
       <td style="padding:0.5em 0.5em;"><b>TODO:</b> this page is too short <i>(See: <a href="../Category:ToDo.html" title="Category:ToDo">To-Do List</a>)</i>
</td>
      </tr>
     </tbody>
    </table>
   </div>
  </article>
  <footer>
   <ul role="list">
    <li>
     <a href="../index.html">
      Home
     </a>
    </li>
    <li>
     Mirrored on 2026-01-14
    </li>
    <li>
     <a href="http://www.gnu.org/copyleft/fdl.html" rel="license">
      GFDL 1.2
     </a>
    </li>
    <li>
     <a href="https://wiki.contextgarden.net/Document_layout_and_layers/Grid_typesetting">
      Original page
     </a>
    </li>
   </ul>
  </footer>
 </body>
</html>
