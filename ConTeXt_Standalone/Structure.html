<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <link href="../style.css" rel="stylesheet">
  <link href="../favicon.ico" rel="icon" sizes="32x32">
  <title>
   ConTeXt Standalone/Structure&mdash;ConTeXt Wiki Mirror
  </title>
  <link href="https://wiki.contextgarden.net/ConTeXt_Standalone/Structure" rel="canonical">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="#241504" name="theme-color">
  <meta content="light dark" name="color-scheme">
 </head>
 <body>
  <header>
   <h1 id="page-title">
    ConTeXt Standalone/Structure
   </h1>
   <p>Unofficial <a href="https://wiki.contextgarden.net/">ConTeXt Wiki</a> mirror</p>
   <p>Last modified: <a href="https://wiki.contextgarden.net/index.php?curid=2568&diff=33590">2022-07-01</a>
        </p>
  </header>
  <article>
   <div class="mw-parser-output">
    <p>&lt; <a href="../ConTeXt_Standalone.html" title="ConTeXt Standalone">ConTeXt Standalone</a>
</p>
    <p>Top Level:
</p>
    <ul>
     <li>
      <b>
       current
      </b>
      : main files
     </li>
     <li>
      <b>
       experimental
      </b>
      : experimental LuaTeX and other binaries - doesn&rsquo;t work at the moment
     </li>
    </ul>
    <ul>
     <li>
      <b>
       setup
      </b>
      : installation scripts
     </li>
     <li>
      <b>
       pragma
      </b>
      : the same kind of zips as Hans provides on
      <a class="external free" href="http://www.pragma-ade.nl/download-1.htm" rel="nofollow">
       http://www.pragma-ade.nl/download-1.htm
      </a>
     </li>
    </ul>
    <ul>
     <li>
      <b>
       doc
      </b>
      : ConTeXt manuals from
      <a class="external free" href="http://www.pragma-ade.nl/overview.htm" rel="nofollow">
       http://www.pragma-ade.nl/overview.htm
      </a>
      (may move)
     </li>
    </ul>
    <div class="toc" id="toc">
     <input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox">
     <div class="toctitle" dir="ltr" lang="en">
      <h2>
       Contents
      </h2>
      <span class="toctogglespan">
       <label class="toctogglelabel" for="toctogglecheckbox">
       </label>
      </span>
     </div>
     <ul>
      <li class="toclevel-1 tocsection-1">
       <a href="#current">
        <span class="tocnumber">
         1
        </span>
        <span class="toctext">
         current
        </span>
       </a>
       <ul>
        <li class="toclevel-2 tocsection-2">
         <a href="#base">
          <span class="tocnumber">
           1.1
          </span>
          <span class="toctext">
           base
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-3">
         <a href="#bin">
          <span class="tocnumber">
           1.2
          </span>
          <span class="toctext">
           bin
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-4">
         <a href="#context">
          <span class="tocnumber">
           1.3
          </span>
          <span class="toctext">
           context
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-5">
         <a href="#fonts">
          <span class="tocnumber">
           1.4
          </span>
          <span class="toctext">
           fonts
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-6">
         <a href="#misc">
          <span class="tocnumber">
           1.5
          </span>
          <span class="toctext">
           misc
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-7">
         <a href="#modules">
          <span class="tocnumber">
           1.6
          </span>
          <span class="toctext">
           modules
          </span>
         </a>
        </li>
       </ul>
      </li>
      <li class="toclevel-1 tocsection-8">
       <a href="#Example_installation_.28on_Windows.29">
        <span class="tocnumber">
         2
        </span>
        <span class="toctext">
         Example installation (on Windows)
        </span>
       </a>
       <ul>
        <li class="toclevel-2 tocsection-9">
         <a href="#Create_the_directories">
          <span class="tocnumber">
           2.1
          </span>
          <span class="toctext">
           Create the directories
          </span>
         </a>
        </li>
        <li class="toclevel-2 tocsection-10">
         <a href="#Downloading">
          <span class="tocnumber">
           2.2
          </span>
          <span class="toctext">
           Downloading
          </span>
         </a>
         <ul>
          <li class="toclevel-3 tocsection-11">
           <a href="#Begin_the_download">
            <span class="tocnumber">
             2.2.1
            </span>
            <span class="toctext">
             Begin the download
            </span>
           </a>
          </li>
          <li class="toclevel-3 tocsection-12">
           <a href="#Base_2">
            <span class="tocnumber">
             2.2.2
            </span>
            <span class="toctext">
             Base
            </span>
           </a>
          </li>
          <li class="toclevel-3 tocsection-13">
           <a href="#Binaries">
            <span class="tocnumber">
             2.2.3
            </span>
            <span class="toctext">
             Binaries
            </span>
           </a>
          </li>
          <li class="toclevel-3 tocsection-14">
           <a href="#ConTeXt_2">
            <span class="tocnumber">
             2.2.4
            </span>
            <span class="toctext">
             ConTeXt
            </span>
           </a>
          </li>
          <li class="toclevel-3 tocsection-15">
           <a href="#Fonts_2">
            <span class="tocnumber">
             2.2.5
            </span>
            <span class="toctext">
             Fonts
            </span>
           </a>
          </li>
          <li class="toclevel-3 tocsection-16">
           <a href="#Miscellanea">
            <span class="tocnumber">
             2.2.6
            </span>
            <span class="toctext">
             Miscellanea
            </span>
           </a>
          </li>
          <li class="toclevel-3 tocsection-17">
           <a href="#Extras">
            <span class="tocnumber">
             2.2.7
            </span>
            <span class="toctext">
             Extras
            </span>
           </a>
          </li>
          <li class="toclevel-3 tocsection-18">
           <a href="#Project">
            <span class="tocnumber">
             2.2.8
            </span>
            <span class="toctext">
             Project
            </span>
           </a>
          </li>
         </ul>
        </li>
        <li class="toclevel-2 tocsection-19">
         <a href="#Building_the_formats">
          <span class="tocnumber">
           2.3
          </span>
          <span class="toctext">
           Building the formats
          </span>
         </a>
         <ul>
          <li class="toclevel-3 tocsection-20">
           <a href="#Kpathsea">
            <span class="tocnumber">
             2.3.1
            </span>
            <span class="toctext">
             Kpathsea
            </span>
           </a>
          </li>
          <li class="toclevel-3 tocsection-21">
           <a href="#luaTeX">
            <span class="tocnumber">
             2.3.2
            </span>
            <span class="toctext">
             luaTeX
            </span>
           </a>
          </li>
         </ul>
        </li>
        <li class="toclevel-2 tocsection-22">
         <a href="#Updating">
          <span class="tocnumber">
           2.4
          </span>
          <span class="toctext">
           Updating
          </span>
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <h2>
     <span class="mw-headline" id="current">
      current
     </span>
    </h2>
    <h3>
     <span class="mw-headline" id="base">
      base
     </span>
    </h3>
    <p>Base TeX and metapost files, stored as
</p>
    <pre>section/<i>TDS</i>
</pre>
    <p>There are currently files for:
</p>
    <ul>
     <li>
      tex -
      <b>
       plain TeX
      </b>
     </li>
     <li>
      metapost -
      <b>
       plain metapost
      </b>
      (including metaobj - for unknown reason - they were in Hans's distribution, sa I took them as well)
     </li>
     <li>
      xetex -
      <b>
       XeTeX
      </b>
      : only tex-text font mapping
     </li>
    </ul>
    <p><i>Hans has asked me several times why there is tex/tex/something and metapost/metapost/something (instead of one metapost less). This is because that&rsquo;s the only way to split TeX and Metapost while still allowing one to use (an obscure example)</i>
</p>
    <pre>rsync -av rsync://contextgarden.net'/minimals/current/base/xetex/ /minimals/current/base/metapost/' destination
</pre>
    <p><i>leaving the plain TeX files on the server and not loosing TDS compliance. Also, once I add the documentation, there will be more than just metapost/metapost, but also metapost/doc.</i>
</p>
    <p><i>One little problem: base metapost files are behind time compared to the binaries. Should anyone need newer files, feel free to complain and we will add them.</i>
</p>
    <h3>
     <span class="mw-headline" id="bin">
      bin
     </span>
    </h3>
    <p>Binaries, stored as
</p>
    <pre>engine/platform/<i>TDS</i>
</pre>
    <p>where platform can be mswin, linux, linux-64, osx-intel, osx-ppc, sun, and engine is
</p>
    <ul>
     <li>
      <b>
       context
      </b>
      : stubs, mtxrun, luatools, texmfstart
     </li>
     <li>
      <b>
       common
      </b>
      : most not-so-fast-changing binaries from TeX Live
     </li>
     <li>
      <b>
       luatex
      </b>
     </li>
     <li>
      <b>
       metapost
      </b>
     </li>
     <li>
      <b>
       pdftex
      </b>
     </li>
     <li>
      <b>
       xetex
      </b>
     </li>
    </ul>
    <p>Special:
</p>
    <ul>
     <li>
      <b>
       man
      </b>
      : man pages
     </li>
     <li>
      <b>
       mswin
      </b>
      : rsync, unzip
     </li>
    </ul>
    <h3>
     <span class="mw-headline" id="context">
      context
     </span>
    </h3>
    <p>ConTeXt distributions, stored as
</p>
    <pre> version/<i>TDS</i>
</pre>
    <p>where version could be
</p>
    <ul>
     <li>
      <b>
       current
      </b>
     </li>
     <li>
      <b>
       beta
      </b>
      (preferred one for testers, will default to current if not present)
     </li>
     <li>
      <b>
       alpha
      </b>
      (rarely released, will default to beta if not present)
     </li>
     <li>
      <b>
       experimental
      </b>
      (not to be used)
     </li>
     <li>
      <b>
       YYY.MM.DD
      </b>
      (but not all of them are available)
     </li>
    </ul>
    <p>You can fetch a specific version with
</p>
    <pre>--context=<i>version</i>
</pre>
    <p>in <code>mtx-update.lua</code>.
</p>
    <h3>
     <span class="mw-headline" id="fonts">
      fonts
     </span>
    </h3>
    <p><b>Fonts will be reorganized!</b>
</p>
    <p>Fonts, currently stored as
</p>
    <pre>type/<i>TDS</i>
</pre>
    <p>where type is:
</p>
    <ul>
     <li>
      <b>
       common
      </b>
      : to be used with both pdfTeX, LuaTeX and XeTeX (mostly math & some other fonts)
     </li>
     <li>
      <b>
       old
      </b>
      : tfm, enc, map files: only for pdftex
     </li>
     <li>
      <b>
       new
      </b>
      : opentype fonts: only for LuaTeX & XeTeX
     </li>
     <li>
      <b>
       other
      </b>
      : pxfonts, txfonts, ... optional (not downloaded by default)
     </li>
    </ul>
    <h3>
     <span class="mw-headline" id="misc">
      misc
     </span>
    </h3>
    <p>A special one. Currently has:
</p>
    <ul>
     <li>
      <b>
       setuptex
      </b>
      : to setup a distribution, usually needs to be put on the top of TeX trees hierarchy
     </li>
     <li>
      <b>
       web2c
      </b>
      : setup files (texmf.cnf) - may change location in future
     </li>
    </ul>
    <h3>
     <span class="mw-headline" id="modules">
      modules
     </span>
    </h3>
    <p>Third-party modules, stored ass
</p>
    <pre>module/<i>TDS</i>
</pre>
    <p>where the available modules are synced from <a class="external free" href="http://modules.contextgarden.net" rel="nofollow">http://modules.contextgarden.net</a>. If you would like your module to be added, request it on the mailing list.
</p>
    <h2>
     <span id="Example_installation_(on_Windows)">
     </span>
     <span class="mw-headline" id="Example_installation_.28on_Windows.29">
      Example installation (on Windows)
     </span>
    </h2>
    <p>Here&rsquo;s how I (<a class="new" href="../index.php?title=User:JCSalomon&action=edit&redlink=1" title="User:JCSalomon (page does not exist)">Joel Salomon</a>) am installing ConTeXt on my machine.  It works for me; your mileage may vary.
</p>
    <p>First I created a root directory for the installation; I install &ldquo;personal&rdquo; programs under <code>%USERPROFILE%\Programs</code>, so I create the directory <code>USERPROFILE%\Programs\ConTeXt</code>.  If you&rsquo;re working from the command-line, you might want to set an environment variable for this, <i>e.g.</i>,
</p>
    <pre>set CONTEXTROOT=%USERPROFILE%\Programs\ConTeXt
</pre>
    <p>&mdash;just be aware that if you&rsquo;re setting the variables below in the Windows dialog box, you&rsquo;ll have to expand all uses of <code>%CONTEXTROOT%</code> yourself.  (A &lsquo;portable apps&rsquo; version of ConTeXt would set those variables in the launcher/wrapper.)  I&rsquo;m going to phrase the rest of this section in terms of the command-line.
</p>
    <p>This effort is closely related to [<a class="external text" href="http://minimals.contextgarden.net/setup/context-installer%7CVyatcheslav&rsquo;s" rel="nofollow">GUI installer</a>]; I hope this makes explicit all the installer does.
</p>
    <p>Note that my system has Ruby installed; I don&rsquo;t yet understand how to include a minimal Ruby.
</p>
    <h3>
     <span class="mw-headline" id="Create_the_directories">
      Create the directories
     </span>
    </h3>
    <p>Following the arrangement from <a href="../Windows_Installation#Stand-alone_ConTeXt_distribution.html" title="Windows Installation">mswincontext.zip</a> and the ConTeXt Standalone&rsquo;s download script, generate the following TDS trees, and add the binaries&rsquo; installation directory to the system path:
</p>
    <pre>cd %CONTEXTROOT%

mkdir texmf texmf-context texmf-extra texmf-fonts texmf-local texmf-mswin texmf-mswin\bin texmf-project texmf-var %TEMP%\texmf-cache

set PATH=%PATH%;%CONTEXTROOT%\texmf-mswin\bin;

set OSFONTDIR=%SystemRoot%\Fonts

set TEXMFMAIN=%CONTEXTROOT%\texmf
set TEXMFCACHE=%TEMP%\texmf-cache
set TEXMFCONTEXT=%CONTEXTROOT%\texmf-context
set TEXMFEXTRA=%CONTEXTROOT%\texmf-extra
set TEXMFFONTS=%CONTEXTROOT%\texmf-fonts
set TEXMFLOCAL=%CONTEXTROOT%\texmf-local
set TEXMFOS=%CONTEXTROOT%\texmf-mswin
set TEXMFPROJECT=%CONTEXTROOT%\texmf-project
set TEXMFVAR=%CONTEXTROOT%\texmf-var
set VARTEXMF=%CONTEXTROOT%\texmf-var
</pre>
    <table style="background-color:#ddddee;color:#000000;border:1px solid #606060;margin:1em 5% 1em 5%;">
     <tbody>
      <tr>
       <td style="padding:0.5em 0.5em;"><ul class="demo"><li class="rendering"><img height="48" src="../wikiteximage/d8db8740e408c0191e8d08a98e7da5fa.webp" width="31"></li></ul><br>
</td>
       <td style="padding:0.5em 0.5em;"><b>TODO:</b> Some of these might not be needed; will someone who knows which please edit this list? <i>(See: <a href="../Category:ToDo.html" title="Category:ToDo">To-Do List</a>)</i>
</td>
      </tr>
     </tbody>
    </table>
    <p><br>
Also, tell the programs what directories have TDS trees, and where to look for configuration settings:
</p>
    <pre>set TEXMFCNF=%CONTEXTROOT%\texmf{-local,-context,}\web2c
set TEXMF={%TEXMFMAIN%,%TEXMFLOCAL%,%TEXMFCONTEXT%,%TEXMFOS%,%TEXMFPROJECT%,%TEXMFFONTS%,%TEXMFEXTRA%,%VARTEXMF%}
</pre>
    <p>(As stated above, you may need to expand these, <i>e.g.</i>, replace <code>%TEXMFMAIN%</code> with <code>%USERPROFILE%\Programs\ConTeXt\texmf</code>.
</p>
    <h3>
     <span class="mw-headline" id="Downloading">
      Downloading
     </span>
    </h3>
    <p>I&rsquo;ve broken the <code>rsync</code> commands into multiple lines for readability, but you need everything on one line, space-separated. Note also that each TDS tree has its own <code>rsync</code> call; that lets me add the <code>--delete</code> option safely.
</p>
    <h4>
     <span class="mw-headline" id="Begin_the_download">
      Begin the download
     </span>
    </h4>
    <p>I need <code>rsync</code>, so I download it to the binaries directory, which I&rsquo;ve already put on the path.  Note that <code>rsync</code> runs under the Cygwin subsystem, so I need to set an environment variable telling it to play nicely with Windows&rsquo;s ideas of file ownership.  This variable doesn&rsquo;t need to be permanently set (and if you run Cygwin, it probably shouldn&rsquo;t be); set it temporarily before you run <code>rsync</code>.  My system has <code>wget</code> installed so I&rsquo;ll use that, but any method of downloading should work fine.
</p>
    <pre>set CYGWIN=nontsec

wget -P texmf-mswin\bin http://minimals.contextgarden.net/setup/mswin/bin/rsync.exe
wget -P texmf-mswin\bin http://minimals.contextgarden.net/setup/mswin/bin/cygwin1.dll
</pre>
    <p>If I were using <code>mtx-update</code> to manage the install, I&rsquo;d run
</p>
    <pre>rsync -rpztlv --exclude 'rsync.exe' --exclude 'cygwin1.dll' rsync://contextgarden.net/minimals/setup/mswin/bin/ texmf-mswin/bin
texlua texmf-mswin\bin\mtxrun.lua --verbose --script texmf-mswin\bin\mtx-update.lua --update --force --engine=all --texroot=%CONTEXTROOT%
</pre>
    <p>but I&rsquo;m going to try to exercise much finer control than <code>mtx-update</code> allows for.  I did adapt the output of an <code>mtx-update</code> run (without <code>--force</code>) to generate the <code>rsync</code> calls below.
</p>
    <h4>
     <span class="mw-headline" id="Base_2">
      Base
     </span>
    </h4>
    <p>Download the base TeX files, as mentioned above.  I moved <code>web2c</code> here from the miscellanea section, so the tree is updated in a single run. Note that the <code>web2c</code> directory does <i>not</i> have a trailing &lsquo;/&rsquo;.  That&rsquo;s because it goes <i>into</i> a TDS tree, rather than containing (part of) one; omitting the &lsquo;/&rsquo; gives us the directory <code>&hellip;/texmf/web2c</code>.
</p>
    <pre>rsync -rpztlv --stats contextgarden.net::'minimals/current/base/tex/
                                          minimals/current/base/metapost/
                                          minimals/current/base/xetex/
                                          minimals/current/misc/web2c' texmf
</pre>
    <h4>
     <span class="mw-headline" id="Binaries">
      Binaries
     </span>
    </h4>
    <p>Download binaries for all engines, plus the specials, for the <code>mswin</code> platform.  For a &ldquo;legacy-free&rdquo; installation, omitting the line with PDFTeX <i>should</i> work&mdash;but I haven&rsquo;t tested it.
</p>
    <pre>rsync -rpztlv --stats contextgarden.net::'minimals/current/bin/context/mswin/
                                          minimals/current/bin/common/mswin/
                                          minimals/current/bin/metapost/mswin/
                                          minimals/current/bin/pdftex/mswin/
                                          minimals/current/bin/xetex/mswin/
                                          minimals/current/bin/luatex/mswin/
                                          minimals/current/bin/man/' texmf-mswin
</pre>
    <p>(Perhaps the <code>man</code> tree should be placed elsewhere; <code>texmf</code>, or maybe <code>texmf-extra</code>?)
</p>
    <h4>
     <span class="mw-headline" id="ConTeXt_2">
      ConTeXt
     </span>
    </h4>
    <p>The more adventurous can replace <code>current</code> with <code>alpha</code>, <code>beta</code>, <code>experimental</code>, or <code>latest</code>.
</p>
    <pre>rsync -rpztlv --stats contextgarden.net::'minimals/current/context/current/
                                          minimals/current/context/img/
                                          minimals/current/context/config/' texmf-context
</pre>
    <h4>
     <span class="mw-headline" id="Fonts_2">
      Fonts
     </span>
    </h4>
    <p>Directory <code>other</code> is optional; <code>old</code> can perhaps be omitted for a &ldquo;legacy-free&rdquo; (<i>i.e.</i>, PDFTeX-free) setup.
</p>
    <pre>rsync -rpztlv --stats contextgarden.net::'minimals/current/fonts/new/
                                          minimals/current/fonts/common/
                                          minimals/current/fonts/other/
                                          minimals/current/fonts/old/' texmf-fonts
</pre>
    <h4>
     <span class="mw-headline" id="Miscellanea">
      Miscellanea
     </span>
    </h4>
    <p>On the initial run, you may want to download the <code>setuptex.*</code> files; I adapted the list of directory trees from there.
</p>
    <pre>rsync -rpztlv --stats contextgarden.net::minimals/current/misc/setuptex/ .
</pre>
    <h4>
     <span class="mw-headline" id="Extras">
      Extras
     </span>
    </h4>
    <p>My guess is that <code>texmf-extra</code> is a good place to put the various modules mentioned above&mdash;at which point the installation can no longer be called &ldquo;minimal&rdquo;.  The invocation would look something like this:
</p>
    <pre>rsync -rpztlv --stats contextgarden.net::'minimals/current/modules/f-urwgaramond/
                                          minimals/current/modules/t-bnf/
                                          minimals/current/modules/&hellip;/' texmf-extra
</pre>
    <p>Include whatever modules you&rsquo;d like.
</p>
    <h4>
     <span class="mw-headline" id="Project">
      Project
     </span>
    </h4>
    <p>I have no idea what goes into <code>texmf-project</code>, nor where it comes from; I&rsquo;m including this directory only because the installation scripts refer to it.
</p>
    <h3>
     <span class="mw-headline" id="Building_the_formats">
      Building the formats
     </span>
    </h3>
    <p>The commands below were excerpted from a run of <code>texlua texmf-mswin\bin\mtxrun.lua  --verbose --script texmf-mswin\bin\mtx-update.lua --make --engine=all --texroot=%CONTEXTROOT%</code>.
</p>
    <h4>
     <span class="mw-headline" id="Kpathsea">
      Kpathsea
     </span>
    </h4>
    <p>PDFTeX and XeTeX use Kpathsea and its <code>ls-r</code> databases to find files.  Also, I let <code>texexec</code>handle the generating of formats.  I don&rsquo;t know what the <code>--all</code> option does; I want a minimal (necessary and sufficient) set of formats, which I think this is:
</p>
    <pre>mktexlsr
texexec --make --all --pdftex metafun cont-en
texexec --make --all --xetex metafun cont-en
</pre>
    <h4>
     <span class="mw-headline" id="luaTeX">
      luaTeX
     </span>
    </h4>
    <p>LuaTeX has its own databases, and its own way of generating formats:
</p>
    <pre>luatools --generate
luatools --ini --compile cont-en
</pre>
    <h3>
     <span class="mw-headline" id="Updating">
      Updating
     </span>
    </h3>
    <p>I haven&rsquo;t tried this yet, but repeating the <code>rsync</code> calls for the Base, Binaries, ConTeXt, Fonts, and Extras trees, perhaps including the <code>--delete</code> option, followed by rebuilding the databases & formats, <i>should</i> work.
</p>
   </div>
  </article>
  <footer>
   <ul role="list">
    <li>
     <a href="../index.html">
      Home
     </a>
    </li>
    <li>
     Mirrored on 2026-01-11
    </li>
    <li>
     <a href="http://www.gnu.org/copyleft/fdl.html" rel="license">
      GFDL 1.2
     </a>
    </li>
    <li>
     <a href="https://wiki.contextgarden.net/ConTeXt_Standalone/Structure">
      Original page
     </a>
    </li>
   </ul>
  </footer>
 </body>
</html>
